<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <!-- VIEWPORT √öNICA E OTIMIZADA PARA PWA MOBILE -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <!-- TEMA E ICONE -->
  <meta name="theme-color" content="#8e44ad" />
  <link rel="icon" type="image/x-icon" href="images/favicon.ico">
  <!-- BIBLIOTECA PDF -->  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <!-- TITULO DA GUIA -->
  <title>Sistema De Ilumina√ß√£o Viza Atacadista</title>
  <style>
      * {
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
      margin: 0;
      padding: 0;
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
      color: #333;
      min-height: 100vh;
      line-height: 1.6;
    }
    
    /* Espa√ßo para menu inferior apenas em mobile */
    @media (max-width: 767px) {
      body {
        padding-bottom: 80px;
      }
    }

        /* ========== SISTEMA DE NOTIFICA√á√ïES TOAST ========== */
    
    /* Container das notifica√ß√µes */
    .toast-container {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 10000;
      display: flex;
      flex-direction: column;
      gap: 10px;
      max-width: 400px;
      pointer-events: none;
    }

    /* Estilo base do toast */
    .toast {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(15px);
      border-radius: 12px;
      padding: 16px 20px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
      border: 1px solid rgba(255, 255, 255, 0.2);
      display: flex;
      align-items: flex-start;
      gap: 12px;
      max-width: 350px;
      min-width: 320px;
      transform: translateX(100%);
      opacity: 0;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      pointer-events: auto;
      position: relative;
      overflow: hidden;
    }

    /* Toast vis√≠vel */
    .toast.show {
      transform: translateX(0);
      opacity: 1;
    }

    /* Toast saindo */
    .toast.hide {
      transform: translateX(100%);
      opacity: 0;
      margin-bottom: -80px;
    }

    /* √çcones dos toasts */
    .toast-icon {
      font-size: 20px;
      flex-shrink: 0;
      margin-top: 2px;
    }

    /* Conte√∫do do toast */
    .toast-content {
      flex: 1;
      min-width: 0;
    }

    .toast-title {
      font-weight: 600;
      font-size: 14px;
      margin: 0 0 4px 0;
      color: #2c3e50;
      line-height: 1.3;
    }

    .toast-message {
      font-size: 13px;
      color: #64748b;
      margin: 0;
      line-height: 1.4;
    }

    /* Bot√£o de fechar */
    .toast-close {
      background: none;
      border: none;
      color: #94a3b8;
      cursor: pointer;
      padding: 0;
      width: 20px;
      height: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 4px;
      transition: all 0.2s ease;
      flex-shrink: 0;
    }

    .toast-close:hover {
      background: rgba(0, 0, 0, 0.1);
      color: #64748b;
    }

    /* Barra de progresso */
    .toast-progress {
      position: absolute;
      bottom: 0;
      left: 0;
      height: 3px;
      background: currentColor;
      border-radius: 0 0 12px 12px;
      opacity: 0.3;
      transition: width linear;
    }

    .toast.success {
      border-left: 4px solid #10b981;
    }
    .toast.success .toast-icon { color: #10b981; }
    .toast.success .toast-progress { background: #10b981; }

    .toast.error {
      border-left: 4px solid #ef4444;
    }
    .toast.error .toast-icon { color: #ef4444; }
    .toast.error .toast-progress { background: #ef4444; }

    .toast.warning {
      border-left: 4px solid #f59e0b;
    }
    .toast.warning .toast-icon { color: #f59e0b; }
    .toast.warning .toast-progress { background: #f59e0b; }

    .toast.info {
      border-left: 4px solid #3b82f6;
    }
    .toast.info .toast-icon { color: #3b82f6; }
    .toast.info .toast-progress { background: #3b82f6; }

    .toast.system {
      border-left: 4px solid #8b5cf6;
    }
    .toast.system .toast-icon { color: #8b5cf6; }
    .toast.system .toast-progress { background: #8b5cf6; }

    /* ========== MENU INFERIOR ESTILO APP ========== */
    
    /* ========== NAVEGA√á√ÉO NO CABE√áALHO ========== */
    .bottom-nav {
      display: none; /* Oculto por padr√£o no desktop */
    }
    
    @media (max-width: 767px) {
      .bottom-nav {
        display: block; /* Mostrar apenas no mobile */
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(20px);
        border-top: 1px solid rgba(0, 0, 0, 0.1);
        padding: 8px 0;
        z-index: 1000;
        box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.15);
        margin-top: 0;
      }
    }
    
    .nav-container {
      display: flex;
      justify-content: space-around;
      align-items: center;
      max-width: 500px;
      margin: 0 auto;
    }
    
    .nav-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 6px 8px;
      text-decoration: none;
      color: #666;
      border-radius: 12px;
      transition: all 0.3s ease;
      min-width: 60px;
      font-size: 11px;
      font-weight: 600;
    }
    
    .nav-item.active {
      color: #8e44ad;
      background: rgba(142, 68, 173, 0.1);
    }
    
    .nav-item:hover {
      color: #8e44ad;
      background: rgba(142, 68, 173, 0.05);
    }
    
    .nav-icon {
      font-size: 20px;
      margin-bottom: 2px;
      line-height: 1;
    }
    
    .nav-label {
      font-size: 10px;
      font-weight: 500;
      text-align: center;
      line-height: 1.2;
    }

    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(15px);
      padding: 15px 20px;
      box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
      border-bottom: 1px solid rgba(255, 255, 255, 0.2);
      position: sticky;
      top: 0;
      z-index: 999;
      gap: 20px;
    }
    
    .header-left {
      display: flex;
      align-items: center;
      gap: 15px;
      flex: 0 0 auto;
    }
    
    .header-center {
      flex: 0 0 auto;
      text-align: left;
      margin-left: 40px;
    }
    
    .header-title-section {
      display: flex;
      align-items: center;
      gap: 15px;
      margin-bottom: 2px;
    }
    
    .header-title {
      font-size: 18px;
      font-weight: 700;
      color: #2c3e50;
      margin: 0;
      line-height: 1.2;
    }
    
    .header-subtitle {
      font-size: 12px;
      color: #6c757d;
      margin: 0;
      font-weight: 500;
      text-align: left;
      margin-left: 0;
    }
    
    .header-right {
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex: 1;
      gap: 25px;
    }
    
    .header-nav-section {
      display: flex;
      align-items: center;
      gap: 20px;
      flex: 1;
      justify-content: center;
    }
    
    .header-logo-right {
      flex: 0 0 auto;
    }

    .logo {
      height: 40px;
      object-fit: contain;
    }
    
    nav a {
      margin: 0 8px;
      text-decoration: none;
      color: #333;
      font-weight: 600;
      padding: 6px 12px;
      border-radius: 8px;
      transition: all 0.3s ease;
      display: inline-block;
      font-size: 14px;
    }
    
    nav a:hover {
      background: rgba(142,68,173,0.1);
      color: #8e44ad;
    }

    /* Status da conex√£o no header */
    .status-conexao {
      font-size: 11px;
      font-weight: 700;
      transition: all 0.3s ease;
      white-space: nowrap;
      padding: 4px 8px;
      border-radius: 12px;
      background: rgba(255, 255, 255, 0.8);
      border: 1px solid rgba(0, 0, 0, 0.1);
    }
    
    .status-online {
      color: #10b981;
    }
    
    .status-offline {
      color: #ef4444;
    }
    
    .status-connecting {
      color: #fbbf24;
    }

    /* Container principal */
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 30px;
      margin-left: 280px; /* Adiciona margem esquerda para dar espa√ßo ao √≠ndice */
    }

    /* √çndice flutuante */
    .floating-index {
      position: fixed;
      top: 50%;
      left: 20px;
      transform: translateY(-50%);
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(15px);
      border-radius: 16px;
      padding: 20px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
      border: 1px solid rgba(255, 255, 255, 0.2);
      z-index: 1000;
      max-height: 70vh;
      overflow-y: auto;
      width: 240px;
      transition: all 0.3s ease;
      
      /* Ocultar barra de rolagem */
      scrollbar-width: none; /* Firefox */
      -ms-overflow-style: none; /* Internet Explorer 10+ */
    }

    /* Ocultar barra de rolagem no WebKit (Chrome, Safari, Edge) */
    .floating-index::-webkit-scrollbar {
      display: none;
    }

    .floating-index.collapsed {
      transform: translateY(-50%) translateX(-210px);
    }

    .index-toggle {
      position: absolute;
      top: 20px;
      right: -40px;
      background: #8e44ad;
      color: white;
      border: none;
      border-radius: 0 8px 8px 0;
      padding: 10px 8px;
      cursor: pointer;
      font-size: 16px;
      transition: all 0.3s ease;
    }

    .index-toggle:hover {
      background: #7b2cbf;
    }

    .index-title {
      font-size: 18px;
      font-weight: 700;
      color: #2c3e50;
      margin-bottom: 15px;
      text-align: center;
      border-bottom: 2px solid #8e44ad;
      padding-bottom: 8px;
    }

    .index-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .index-item {
      margin-bottom: 8px;
    }

    .index-link {
      display: block;
      padding: 8px 12px;
      color: #495057;
      text-decoration: none;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 500;
      transition: all 0.3s ease;
      border-left: 3px solid transparent;
    }

    .index-link:hover {
      background: rgba(142, 68, 173, 0.1);
      color: #8e44ad;
      border-left-color: #8e44ad;
    }

    .index-link.active {
      background: linear-gradient(135deg, #8e44ad, #9b59b6);
      color: white;
      border-left-color: #7b2cbf;
    }

    /* T√≠tulo principal */
    .main-title {
      text-align: center;
      margin-bottom: 40px;
      color: #2c3e50;
    }

    .main-title h1 {
      font-size: 2.5rem;
      font-weight: 800;
      margin: 0 0 10px 0;
      background: linear-gradient(135deg, #8e44ad, #9b59b6);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .main-title p {
      font-size: 1.2rem;
      color: #6c757d;
      margin: 0;
    }

    /* Se√ß√µes do manual */
    .manual-section {
      background: rgba(255, 255, 255, 0.9);
      backdrop-filter: blur(10px);
      border-radius: 16px;
      padding: 30px;
      margin-bottom: 30px;
      box-shadow: 0 8px 32px rgba(0,0,0,0.1);
      border: 1px solid rgba(255,255,255,0.18);
      transition: all 0.3s ease;
      scroll-margin-top: 100px;
    }

    .manual-section:hover {
      transform: translateY(-2px);
      box-shadow: 0 12px 40px rgba(0,0,0,0.15);
    }

    .section-title {
      font-size: 1.8rem;
      font-weight: 700;
      color: #2c3e50;
      margin: 0 0 20px 0;
      display: flex;
      align-items: center;
      gap: 12px;
      position: relative;
      padding-bottom: 10px;
      border-bottom: 2px solid #e9ecef;
    }

    .section-title::after {
      content: '';
      position: absolute;
      bottom: -2px;
      left: 0;
      width: 60px;
      height: 2px;
      background: linear-gradient(90deg, #8e44ad, #9b59b6);
    }

    .section-icon {
      font-size: 1.5rem;
      padding: 8px;
      background: linear-gradient(135deg, #8e44ad, #9b59b6);
      color: white;
      border-radius: 8px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }

    /* Subsse√ß√µes */
    .subsection {
      margin: 25px 0;
      padding: 20px;
      background: linear-gradient(135deg, #f8f9fa, #e9ecef);
      border-radius: 12px;
      border-left: 4px solid #8e44ad;
    }

    .subsection-title {
      font-size: 1.3rem;
      font-weight: 600;
      color: #495057;
      margin: 0 0 15px 0;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    /* Sistema de containers - para esquemas de liga√ß√£o */
    .sistema-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
      gap: 30px;
      margin: 30px 0;
    }

    .sistema-card {
      background: white;
      border-radius: 12px;
      padding: 25px;
      box-shadow: 0 8px 32px rgba(0,0,0,0.1);
      border-left: 4px solid #8e44ad;
    }

    .sistema-title {
      font-size: 1.4rem;
      font-weight: 700;
      color: #2c3e50;
      margin: 0 0 20px 0;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    /* Componentes grid - para visualiza√ß√£o de componentes */
    .componentes-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 20px;
      margin: 20px 0;
    }

    .componente-item {
      display: flex;
      align-items: flex-start;
      gap: 15px;
      padding: 20px;
      background: white;
      border-radius: 12px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
      border-left: 4px solid #8e44ad;
      transition: all 0.3s ease;
    }

    .componente-item:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0,0,0,0.15);
    }

    .componente-icon {
      font-size: 2rem;
      padding: 12px;
      background: linear-gradient(135deg, #8e44ad, #9b59b6);
      color: white;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      min-width: 60px;
      height: 60px;
      flex-shrink: 0;
    }

    .componente-info h4 {
      margin: 0 0 8px 0;
      color: #2c3e50;
      font-weight: 600;
      font-size: 1.1rem;
    }

    .componente-info p {
      margin: 0;
      color: #6c757d;
      font-size: 0.9rem;
      line-height: 1.4;
    }

    /* Sistema de abas - para esquemas de liga√ß√£o */
    .tab-container {
      margin: 20px 0;
    }

    .tab-buttons {
      display: flex;
      gap: 5px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    .tab-button {
      padding: 12px 20px;
      background: #f8f9fa;
      border: 2px solid #e9ecef;
      border-radius: 8px 8px 0 0;
      cursor: pointer;
      font-weight: 600;
      color: #495057;
      transition: all 0.3s ease;
    }

    .tab-button.active {
      background: linear-gradient(135deg, #8e44ad, #9b59b6);
      color: white;
      border-color: #8e44ad;
    }

    .tab-content {
      display: none;
      background: white;
      padding: 25px;
      border: 2px solid #8e44ad;
      border-radius: 0 12px 12px 12px;
    }

    .tab-content.active {
      display: block;
    }

    /* Diagramas de pinagem */
    .pin-diagram {
      background: #f8f9fa;
      border-radius: 8px;
      padding: 20px;
      margin: 15px 0;
      font-family: monospace;
      font-size: 0.9rem;
    }

    .pin-esp32 {
      background: #4a90e2;
      color: white;
      padding: 15px;
      border-radius: 8px;
      margin: 10px 0;
      text-align: center;
    }

    .pin-connection {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px 15px;
      border-bottom: 1px solid #dee2e6;
      position: relative;
      min-height: 30px;
    }
    
    .pin-connection > span:nth-child(2) {
      position: absolute;
      left: 45%;
      transform: translateX(-50%);
      font-size: 1.2em;
      color: #6c757d;
      font-weight: bold;
      background: #f8f9fa;
      padding: 0 10px;
      z-index: 1;
    }

    .pin-left {
      color: #8e44ad;
      font-weight: bold;
    }

    .pin-right {
      color: #10b981;
      font-weight: bold;
    }

    /* Tabelas de especifica√ß√µes */
    .especificacoes-tabela {
      overflow-x: auto;
      margin: 20px 0;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }

    .especificacoes-tabela table {
      width: 100%;
      border-collapse: collapse;
      background: white;
    }

    .especificacoes-tabela thead tr {
      background: linear-gradient(135deg, #fbbf24, #f59e0b);
      color: white;
    }

    .especificacoes-tabela th,
    .especificacoes-tabela td {
      padding: 12px 15px;
      text-align: left;
      border-bottom: 1px solid #ddd;
    }

    .especificacoes-tabela tbody tr:nth-child(even) {
      background: #f8f9fa;
    }

    .especificacoes-tabela tbody tr:hover {
      background: rgba(142, 68, 173, 0.05);
    }

    /* Listas de passos */
    .step-list {
      counter-reset: step-counter;
      list-style: none;
      padding: 0;
      margin: 20px 0;
    }

    .step-item {
      counter-increment: step-counter;
      margin-bottom: 15px;
      padding: 15px 20px;
      background: white;
      border-radius: 10px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
      border-left: 4px solid #fbbf24;
      position: relative;
      transition: all 0.3s ease;
    }

    .step-item:hover {
      transform: translateX(5px);
      box-shadow: 0 6px 20px rgba(0,0,0,0.15);
    }

    .step-item::before {
      content: counter(step-counter);
      position: absolute;
      left: -12px;
      top: 15px;
      background: #fbbf24;
      color: white;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      font-weight: 600;
    }

    .step-title {
      font-weight: 600;
      color: #2c3e50;
      margin-bottom: 8px;
    }

    .step-description {
      color: #6c757d;
      line-height: 1.5;
    }

    /* Caixas de destaque */
    .highlight-box {
      padding: 20px;
      border-radius: 12px;
      margin: 20px 0;
      border-left: 4px solid;
      position: relative;
      backdrop-filter: blur(5px);
    }

    .highlight-box.tip {
      background: rgba(16, 185, 129, 0.1);
      border-left-color: #10b981;
      color: #065f46;
    }

    .highlight-box.warning {
      background: rgba(245, 158, 11, 0.1);
      border-left-color: #f59e0b;
      color: #92400e;
    }

    .highlight-box.danger {
      background: rgba(239, 68, 68, 0.1);
      border-left-color: #ef4444;
      color: #991b1b;
    }

    .highlight-box.info {
      background: rgba(59, 130, 246, 0.1);
      border-left-color: #3b82f6;
      color: #1e40af;
    }

    .highlight-box-icon {
      font-size: 1.2rem;
      margin-right: 10px;
    }

    .highlight-box-title {
      font-weight: 600;
      font-size: 1.1rem;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
    }

    /* Demonstra√ß√µes visuais */
    .demo-container {
      background: #f8f9fa;
      border-radius: 12px;
      padding: 20px;
      margin: 20px 0;
      border: 2px dashed #dee2e6;
      text-align: center;
    }

    .demo-title {
      font-weight: 600;
      color: #495057;
      margin-bottom: 15px;
      font-size: 1.1rem;
    }

    .demo-buttons {
      display: flex;
      justify-content: center;
      gap: 15px;
      flex-wrap: wrap;
      margin-bottom: 15px;
    }

    .demo-btn {
      padding: 12px 24px;
      border: none;
      border-radius: 12px;
      font-weight: 600;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }

    .demo-btn.manual {
      background: linear-gradient(135deg, #8e44ad, #9b59b6);
      color: white;
    }

    .demo-btn.automatico {
      background: linear-gradient(135deg, #fbbf24, #f59e0b);
      color: white;
    }

    .demo-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0,0,0,0.15);
    }

    .demo-status {
      margin-top: 10px;
      padding: 8px 16px;
      border-radius: 8px;
      font-weight: 500;
      display: inline-block;
    }

    .demo-status.manual {
      background: rgba(142, 68, 173, 0.1);
      color: #8e44ad;
      border: 1px solid rgba(142, 68, 173, 0.2);
    }

    .demo-status.automatico {
      background: rgba(251, 191, 36, 0.1);
      color: #f59e0b;
      border: 1px solid rgba(251, 191, 36, 0.2);
    }

    /* Slider de demonstra√ß√£o */
    .demo-slider-container {
      margin: 20px 0;
      padding: 20px;
      background: white;
      border-radius: 12px;
      border: 1px solid #e9ecef;
    }

    .demo-slider {
      -webkit-appearance: none;
      width: 100%;
      height: 8px;
      border-radius: 20px;
      outline: none;
      transition: all 0.3s ease;
      background: linear-gradient(to right, #8e44ad 0%, #8e44ad 50%, #e0e0e0 50%, #e0e0e0 100%);
      margin: 10px 0;
    }

    .demo-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 24px;
      height: 24px;
      background: linear-gradient(135deg, #8e44ad, #9b59b6);
      border-radius: 50%;
      cursor: pointer;
      box-shadow: 0 4px 12px rgba(142,68,173,0.4);
    }

    .demo-value {
      text-align: center;
      font-size: 1.2rem;
      font-weight: 600;
      color: #8e44ad;
      margin-top: 10px;
    }

    /* FAQ */
    .faq-item {
      margin-bottom: 15px;
      background: white;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }

    .faq-question {
      background: linear-gradient(135deg, #f8f9fa, #e9ecef);
      padding: 20px;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
      transition: all 0.3s ease;
      border: none;
      width: 100%;
      text-align: left;
      font-size: 1rem;
      font-weight: 600;
      color: #2c3e50;
    }

    .faq-question:hover {
      background: linear-gradient(135deg, #e9ecef, #dee2e6);
    }

    .faq-question.active {
      background: linear-gradient(135deg, #8e44ad, #9b59b6);
      color: white;
    }

    .faq-icon {
      font-size: 1.2rem;
      transition: transform 0.3s ease;
    }

    .faq-question.active .faq-icon {
      transform: rotate(180deg);
    }

    .faq-answer {
      padding: 0 20px;
      max-height: 0;
      overflow: hidden;
      transition: all 0.3s ease;
      background: white;
    }

    .faq-answer.active {
      padding: 20px;
      max-height: 500px;
    }

    .faq-answer p {
      margin: 0;
      color: #6c757d;
      line-height: 1.6;
    }

    /* Troubleshooting */
    .troubleshoot-item {
      display: flex;
      align-items: flex-start;
      gap: 15px;
      padding: 20px;
      background: white;
      border-radius: 12px;
      margin-bottom: 15px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
      border-left: 4px solid #ef4444;
    }

    .troubleshoot-icon {
      font-size: 1.5rem;
      color: #ef4444;
      margin-top: 5px;
    }

    .troubleshoot-content h4 {
      margin: 0 0 10px 0;
      color: #2c3e50;
      font-weight: 600;
    }

    .troubleshoot-content p {
      margin: 0;
      color: #6c757d;
      line-height: 1.5;
    }

    /* ========== BARRA DE PESQUISA ========== */
    .search-container {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(15px);
      border-radius: 16px;
      padding: 25px 30px;
      margin: 25px 0 30px 0;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
      border: 1px solid rgba(142, 68, 173, 0.1);
    }
    .search-box {
      position: relative;
      display: flex;
      align-items: center;
      gap: 12px;
    }
    .search-icon {
      font-size: 24px;
      color: #8e44ad;
      flex-shrink: 0;
    }
    .search-input {
      flex: 1;
      border: 2px solid #e0e0e0;
      border-radius: 12px;
      padding: 14px 45px 14px 20px;
      font-size: 16px;
      font-family: inherit;
      transition: all 0.3s ease;
      background: white;
      color: #2c3e50;
      outline: none;
    }
    .search-input:focus {
      border-color: #8e44ad;
      box-shadow: 0 0 0 4px rgba(142, 68, 173, 0.1);
    }
    .search-input::placeholder {
      color: #94a3b8;
    }
    .search-clear {
      position: absolute;
      right: 15px;
      background: none;
      border: none;
      font-size: 20px;
      color: #94a3b8;
      cursor: pointer;
      padding: 5px;
      border-radius: 50%;
      transition: all 0.2s ease;
      display: none;
    }
    .search-clear.visible {
      display: block;
    }
    .search-clear:hover {
      background: rgba(0, 0, 0, 0.05);
      color: #64748b;
    }
    .search-results-info {
      margin-top: 12px;
      font-size: 13px;
      color: #64748b;
      display: none;
      align-items: center;
      gap: 10px;
    }
    .search-results-info.visible {
      display: flex;
    }
    .search-navigation {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-left: auto;
    }
    .search-nav-btn {
      background: #8e44ad;
      color: white;
      border: none;
      border-radius: 6px;
      width: 30px;
      height: 30px;
      font-size: 16px;
      cursor: pointer;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .search-nav-btn:hover:not(:disabled) {
      background: #7b2cbf;
      transform: translateY(-1px);
    }
    .search-nav-btn:disabled {
      background: #ccc;
      cursor: not-allowed;
      opacity: 0.5;
    }
    .search-counter {
      font-weight: 600;
      color: #8e44ad;
      min-width: 60px;
      text-align: center;
    }
    .search-highlight {
      background: linear-gradient(120deg, #ffd700 0%, #ffed4e 100%);
      padding: 2px 4px;
      border-radius: 3px;
      font-weight: 600;
      color: #2c3e50;
      transition: all 0.3s ease;
    }
    .search-highlight.active {
      background: linear-gradient(120deg, #8e44ad 0%, #9b59b6 100%);
      color: white;
      padding: 3px 6px;
      box-shadow: 0 0 0 3px rgba(142, 68, 173, 0.2);
      transform: scale(1.1);
    }

    /* Bot√£o de download PDF */
    .download-pdf-btn {
      position: fixed;
      top: 50%;
      right: 20px;
      transform: translateY(-50%);
      background: linear-gradient(135deg, #8e44ad, #7b2cbf);
      color: white;
      border: none;
      border-radius: 12px 0 0 12px;
      padding: 15px 12px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      box-shadow: 0 8px 32px rgba(142, 68, 173, 0.4);
      transition: all 0.3s ease;
      z-index: 1001;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 5px;
      min-height: 80px;
      justify-content: center;
      writing-mode: vertical-rl;
      text-orientation: mixed;
    }

    .download-pdf-btn:hover {
      transform: translateY(-50%) translateX(5px);
      box-shadow: 0 12px 40px rgba(142, 68, 173, 0.6);
      background: linear-gradient(135deg, #7b2cbf, #6f42c1);
    }

    .download-pdf-btn:disabled {
      background: #6c757d;
      cursor: not-allowed;
      transform: translateY(-50%);
      box-shadow: 0 4px 15px rgba(108, 117, 125, 0.3);
    }

    .download-pdf-icon {
      font-size: 18px;
      margin-bottom: 5px;
    }

    .download-pdf-text {
      font-size: 11px;
      text-align: center;
      line-height: 1.2;
    }

    /* Loader para PDF */
    .pdf-loading {
      display: inline-block;
      width: 16px;
      height: 16px;
      border: 2px solid rgba(255,255,255,.3);
      border-radius: 50%;
      border-top-color: #fff;
      animation: spin 1s ease-in-out infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Modal de progresso do PDF */
    .pdf-progress-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 10000;
      backdrop-filter: blur(5px);
    }

    .pdf-progress-content {
      background: white;
      border-radius: 16px;
      padding: 30px;
      text-align: center;
      max-width: 400px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    }

    .pdf-progress-title {
      font-size: 1.2rem;
      font-weight: 700;
      color: #2c3e50;
      margin-bottom: 15px;
    }

    .pdf-progress-bar-container {
      background: #e9ecef;
      border-radius: 10px;
      height: 8px;
      margin: 20px 0;
      overflow: hidden;
    }

    .pdf-progress-bar {
      background: linear-gradient(135deg, #8e44ad, #9b59b6);
      height: 100%;
      width: 0%;
      transition: width 0.3s ease;
    }

    .pdf-progress-text {
      color: #6c757d;
      font-size: 14px;
      margin-top: 10px;
    }

    /* Ajustes para impress√£o/PDF */
    @media print, (max-width: 0) {
      .floating-index,
      .download-pdf-btn,
      .toast-container,
      .demo-container,
      .pdf-progress-modal,
      header nav {
        display: none !important;
      }
      
      header {
        padding: 10px 15px !important;
        background: white !important;
        box-shadow: none !important;
        border-bottom: 2px solid #8e44ad !important;
        position: static !important;
      }
      
      body {
        background: white !important;
        font-size: 12px !important;
        line-height: 1.4 !important;
      }
      
      .manual-section {
        page-break-inside: avoid;
        margin-bottom: 20px !important;
        background: white !important;
        box-shadow: none !important;
        border: 1px solid #dee2e6 !important;
        padding: 15px !important;
      }
      
      .container {
        max-width: none !important;
        padding: 10px !important;
        margin-left: 0 !important;
      }
      
      .main-title {
        margin-bottom: 20px !important;
      }
      
      .main-title h1 {
        color: #2c3e50 !important;
        -webkit-text-fill-color: #2c3e50 !important;
        font-size: 1.8rem !important;
      }
      
      .main-title p {
        color: #6c757d !important;
        font-size: 1rem !important;
      }
      
      .section-title {
        font-size: 1.2rem !important;
        color: #2c3e50 !important;
      }
      
      .section-icon {
        background: #8e44ad !important;
        color: white !important;
      }
      
      .subsection-title {
        font-size: 1rem !important;
        color: #495057 !important;
      }
      
      .highlight-box {
        border: 1px solid #dee2e6 !important;
        background: #f8f9fa !important;
        page-break-inside: avoid;
      }
      
      .step-list {
        page-break-inside: avoid;
      }
      
      .step-item {
        break-inside: avoid;
        margin-bottom: 10px !important;
        padding: 10px !important;
        background: white !important;
        border: 1px solid #dee2e6 !important;
      }
      
      .faq-item {
        page-break-inside: avoid;
        margin-bottom: 10px !important;
        background: white !important;
        border: 1px solid #dee2e6 !important;
      }
      
      .faq-question {
        background: #f8f9fa !important;
        color: #2c3e50 !important;
        padding: 10px !important;
      }
      
      .faq-answer {
        padding: 10px !important;
        background: white !important;
        display: block !important;
        max-height: none !important;
      }
      
      .troubleshoot-item {
        page-break-inside: avoid;
        border: 1px solid #dee2e6 !important;
        background: white !important;
      }

      .tab-content {
        display: block !important;
        border: 1px solid #dee2e6 !important;
        margin-bottom: 15px !important;
      }

      .tab-buttons {
        display: none !important;
      }
    }

    @media (max-width: 1024px) {
      .floating-index {
        position: static;
        transform: none;
        width: 100%;
        margin-bottom: 30px;
      }

      .floating-index.collapsed {
        transform: none;
        display: none;
      }

      .index-toggle {
        display: none;
      }

      .container {
        padding: 20px;
        margin-left: 0;
      }
      
      .download-pdf-btn {
        position: static;
        transform: none;
        writing-mode: horizontal-tb;
        text-orientation: mixed;
        border-radius: 12px;
        margin: 20px auto;
        display: flex;
        flex-direction: row;
        width: auto;
        min-height: auto;
        padding: 12px 20px;
        gap: 10px;
      }
      
      .download-pdf-text {
        font-size: 14px;
      }

      .sistema-container {
        grid-template-columns: 1fr;
      }
      
      .componentes-grid {
        grid-template-columns: 1fr;
      }
      
      .componente-item {
        flex-direction: column;
        text-align: center;
        align-items: center;
      }

      .tab-buttons {
        flex-direction: column;
      }

      .tab-button {
        text-align: center;
        border-radius: 8px;
      }

      .tab-content {
        border-radius: 12px;
      }
    }

    /* Responsividade apenas para MOBILE */
    @media (max-width: 767px) {
      body {
        overflow-x: hidden;
      }
      
      * {
        max-width: 100%;
      }
      
      .toast-container {
        top: 10px;
        right: 10px;
        left: 10px;
        max-width: none;
      }
      
      .toast {
        min-width: auto;
        max-width: none;
        font-size: 12px;
        padding: 12px 16px;
      }

      header {
        padding: 10px 15px;
        gap: 15px;
        flex-direction: column;
      }
      
      /* Reorganizar para mobile: logos primeiro */
      .header-left, .header-right {
        width: auto;
        flex: none;
      }
      
      .header-left {
        order: 1;
        align-self: flex-start;
      }
      
      .header-right {
        order: 2;
        align-self: flex-end;
        position: absolute;
        top: 10px;
        right: 15px;
      }
      
      .header-nav-section {
        display: none; /* Ocultar menu no mobile */
      }
      
      .header-logo-right {
        display: flex;
      }
      
      .header-center {
        order: 3;
        margin-bottom: 0;
        margin-left: 0;
        margin-top: 10px;
        text-align: center;
        width: 100%;
      }
      
      .header-title-section {
        flex-direction: column;
        gap: 8px;
        justify-content: center;
        align-items: center;
      }
      
      .header-title {
        font-size: 16px;
        text-align: center;
        order: 1;
      }
      
      .header-subtitle {
        font-size: 11px;
        text-align: center;
        order: 2;
      }
      
      .status-conexao {
        order: 3;
        font-size: 10px;
        padding: 3px 6px;
        margin-top: 5px;
      }

      header nav {
        display: none; /* Ocultar menu de navega√ß√£o no mobile */
      }

      .logo {
        height: 32px;
      }

      .container {
        padding: 15px;
        margin-left: 0;
      }

      .manual-section {
        padding: 20px 15px;
      }
      
      .search-container {
        padding: 12px 15px;
        margin: 15px 0 20px 0;
      }
      
      .search-box {
        gap: 8px;
      }
      
      .search-icon {
        font-size: 18px;
      }
      
      .search-input {
        padding: 10px 40px 10px 12px;
        font-size: 14px;
        border-radius: 10px;
      }
      
      .search-clear {
        right: 10px;
        font-size: 16px;
      }
      
      .search-results-info {
        flex-direction: column;
        align-items: flex-start;
        gap: 8px;
        margin-top: 10px;
        font-size: 12px;
      }
      
      .search-navigation {
        margin-left: 0;
        width: 100%;
        justify-content: center;
        gap: 6px;
      }
      
      .search-nav-btn {
        width: 28px;
        height: 28px;
        font-size: 14px;
      }
      
      .search-counter {
        min-width: 45px;
        font-size: 12px;
      }

      .main-title h1 {
        font-size: 2rem;
      }

      .section-title {
        font-size: 1.4rem;
        flex-direction: column;
        text-align: center;
        gap: 8px;
      }

      .demo-buttons {
        flex-direction: column;
        align-items: center;
      }

      .demo-btn {
        width: 200px;
      }

      .step-item {
        margin-left: 10px;
      }

      .troubleshoot-item {
        flex-direction: column;
        text-align: center;
      }
      
      .download-pdf-btn {
        position: fixed;
        top: auto;
        bottom: 80px;
        right: 20px;
        transform: none;
        writing-mode: horizontal-tb;
        border-radius: 12px;
        padding: 10px 15px;
        flex-direction: row;
        gap: 8px;
        min-height: auto;
        width: auto;
      }
      
      .download-pdf-text {
        font-size: 12px;
      }
    }

    /* ========== RESPONSIVIDADE SMARTPHONES PEQUENOS ========== */
    @media (max-width: 480px) {
      .search-container {
        padding: 10px 12px;
        margin: 12px 0 15px 0;
        border-radius: 12px;
      }
      
      .search-box {
        gap: 6px;
      }
      
      .search-icon {
        font-size: 16px;
      }
      
      .search-input {
        padding: 8px 35px 8px 10px;
        font-size: 13px;
        border-radius: 8px;
      }
      
      .search-clear {
        right: 8px;
        font-size: 14px;
        padding: 3px;
      }
      
      .search-results-info {
        gap: 6px;
        margin-top: 8px;
        font-size: 11px;
      }
      
      .search-navigation {
        gap: 4px;
      }
      
      .search-nav-btn {
        width: 26px;
        height: 26px;
        font-size: 13px;
      }
      
      .search-counter {
        min-width: 40px;
        font-size: 11px;
      }
    }
  </style>
</head>
<body>
  <!-- Container das notifica√ß√µes -->
  <div id="toast-container" class="toast-container"></div>

  <!-- Menus e Logos-->   
  <header>
    <div class="header-left">
      <a href="/"><img src="images/Viza_Logo.png" alt="Viza" class="logo"></a>
    </div>
    
    <div class="header-center">
      <div class="header-title-section">
        <h1 class="header-title">Sistema De Ilumina√ß√£o Viza</h1>
        <!-- Status da conex√£o -->
        <div id="status-conexao" class="status-conexao status-connecting">
          <span id="status-text">Conectando</span>
        </div>
      </div>
      <p class="header-subtitle">Controle Inteligente De Ilumina√ß√£o</p>
    </div>
    
    <div class="header-right">
      <div class="header-nav-section">
        <nav>
          <a href="/">üè¢ Opera√ß√£o</a>
          <a href="/Visualizacao">üìä Visualiza√ß√£o</a>
          <a href="/Consumo">‚ö° Consumo</a>
          <a href="/Banco">üóÑÔ∏è Banco</a>
          <a href="/Manual">üìñ Manual</a>
        </nav>
      </div>
      
      <div class="header-logo-right">
        <img src="images/Engemase_Logo.png" alt="Engemase" class="logo">
      </div>
    </div>
  </header>

  <!-- √çndice flutuante -->
  <div class="floating-index" id="floatingIndex">
    <button class="index-toggle" onclick="toggleIndex()">üìñ</button>
    <div class="index-title">üìö √çndice do Manual</div>
    <ul class="index-list">
      <li class="index-item"><a href="#introducao" class="index-link">üè† Introdu√ß√£o</a></li>
      <li class="index-item"><a href="#navegacao" class="index-link">üß≠ Navega√ß√£o B√°sica</a></li>
      <li class="index-item"><a href="#controle-geral" class="index-link">üîß Controle Geral</a></li>
      <li class="index-item"><a href="#controle-setores" class="index-link">üè≠ Controle por Setores</a></li>
      <li class="index-item"><a href="#agendamento" class="index-link">‚è∞ Agendamentos</a></li>
      <li class="index-item"><a href="#visualizacao" class="index-link">üëÅÔ∏è Visualiza√ß√£o</a></li>
      <li class="index-item"><a href="#consumo" class="index-link">‚ö° Monitoramento de Consumo</a></li>
      <li class="index-item"><a href="#banco-dados" class="index-link">üóÑÔ∏è Banco de Dados</a></li>
      <li class="index-item"><a href="#esquema-ligacao" class="index-link">üîå Esquemas de Liga√ß√£o</a></li>
      <li class="index-item"><a href="#troubleshooting" class="index-link">üîß Solu√ß√£o de Problemas</a></li>
      <li class="index-item"><a href="#faq" class="index-link">‚ùì Perguntas Frequentes</a></li>
      <li class="index-item"><a href="#contato" class="index-link">üìû Suporte T√©cnico</a></li>
    </ul>
  </div>

  <div class="container">
    <!-- T√≠tulo Principal -->
    <div class="main-title">
      <h1>üìñ Manual de Opera√ß√£o</h1>
      <p>Sistema de Ilumina√ß√£o Viza - Guia Completo para Operadores</p>
    </div>

    <!-- Barra de Pesquisa -->
    <div class="search-container">
      <div class="search-box">
        <span class="search-icon">üîç</span>
        <input 
          type="text" 
          id="searchInput" 
          class="search-input" 
          placeholder="Digite sua busca e pressione ENTER... (Ex: agendamento, controle, consumo)"
          autocomplete="off"
        />
        <button class="search-clear" id="searchClear" onclick="limparPesquisa()">‚úï</button>
      </div>
      <div class="search-results-info" id="searchResultsInfo">
        <span id="searchResultsText"></span>
        <div class="search-navigation" id="searchNavigation" style="display: none;">
          <button class="search-nav-btn" id="searchPrevBtn" onclick="navegarResultadoAnterior()" title="Resultado anterior (Seta ‚Üë)">‚Üë</button>
          <span class="search-counter" id="searchCounter">0/0</span>
          <button class="search-nav-btn" id="searchNextBtn" onclick="navegarProximoResultado()" title="Pr√≥ximo resultado (Seta ‚Üì)">‚Üì</button>
        </div>
      </div>
    </div>

    <!-- Se√ß√£o 1: Introdu√ß√£o -->
    <section class="manual-section" id="introducao">
      <h2 class="section-title">
        <span class="section-icon">üè†</span>
        Introdu√ß√£o ao Sistema
      </h2>
      
      <p>Bem-vindo ao Sistema de Ilumina√ß√£o Viza! Este manual foi elaborado com o objetivo de orientar, de forma clara e acess√≠vel, todos os usu√°rios a utilizarem o sistema com praticidade e seguran√ßa.</p>
      
      <div class="subsection">
        <h3 class="subsection-title">üéØ O que o Sistema Faz</h3>
        <p>O Sistema Viza controla automaticamente a ilumina√ß√£o de tr√™s setores principais:</p>
        <ul>
          <li><strong>üöó Estacionamento:</strong> 225 lumin√°rias distribu√≠das em colunas e √°reas laterais</li>
          <li><strong>üè™ Loja:</strong> 241 lumin√°rias organizadas em fileiras</li>
          <li><strong>üì¶ Dep√≥sito:</strong> 14 lumin√°rias organizadas em fileiras</li>
        </ul>
      </div>

      <div class="highlight-box tip">
        <div class="highlight-box-title">
          <span class="highlight-box-icon">üí°</span>
          Dica Importante
        </div>
        <p>O sistema funciona 24 horas por dia e pode ser controlado remotamente atrav√©s de qualquer dispositivo conectado na rede (computador, tablet ou celular).</p>
      </div>
    </section>

    <!-- Se√ß√£o 2: Navega√ß√£o B√°sica -->
    <section class="manual-section" id="navegacao">
      <h2 class="section-title">
        <span class="section-icon">üß≠</span>
        Navega√ß√£o B√°sica
      </h2>
      
      <div class="subsection">
        <h3 class="subsection-title">üì± Acessando o Sistema</h3>
        <ol class="step-list">
          <li class="step-item">
            <div class="step-title">Abra seu navegador de internet</div>
            <div class="step-description">Use Chrome, Firefox, Safari ou Edge. O sistema funciona em qualquer navegador moderno.</div>
          </li>
          <li class="step-item">
            <div class="step-title">Digite o endere√ßo do sistema</div>
            <div class="step-description">O endere√ßo de acesso ser√° fornecido pelo administrador. Por padr√£o, utilize: http://192.168.4.1</div>
          </li>
          <li class="step-item">
            <div class="step-title">Aguarde o carregamento</div>
            <div class="step-description">A tela principal aparecer√° automaticamente em alguns segundos</div>
          </li>
        </ol>
      </div>

      <div class="subsection">
        <h3 class="subsection-title">üéõÔ∏è Menu Principal</h3>
        <p>O sistema possui 4 telas principais acess√≠veis pelo menu superior:</p>
        <ul>
          <li><strong>üîß Controle:</strong> Para ligar/desligar lumin√°rias e ajustar brilho</li>
          <li><strong>üëÅÔ∏è Visualiza√ß√£o:</strong> Para ver o status de todas as lumin√°rias em tempo real</li>
          <li><strong>‚ö° Consumo:</strong> Para monitorar gastos de energia e custos</li>
          <li><strong>üìñ Manual:</strong> Esta p√°gina com instru√ß√µes completas</li>
        </ul>
      </div>

      <div class="highlight-box info">
        <div class="highlight-box-title">
          <span class="highlight-box-icon">‚ÑπÔ∏è</span>
          Status de Conex√£o
        </div>
        <p>No canto superior direito, voc√™ sempre ver√° um indicador de conex√£o:</p>
        <ul>
          <li><strong>üü¢ Online:</strong> Sistema funcionando normalmente</li>
          <li><strong>üî¥ Offline:</strong> Problema de comunica√ß√£o - verifique a internet</li>
        </ul>
      </div>
    </section>

    <!-- Se√ß√£o 3: Controle Geral -->
    <section class="manual-section" id="controle-geral">
      <h2 class="section-title">
        <span class="section-icon">üîß</span>
        Controle Geral das Lumin√°rias
      </h2>
      
      <div class="subsection">
        <h3 class="subsection-title">üè¢ Controlando Todas as Lumin√°rias</h3>
        <p>Na tela de <strong>Controle</strong>, voc√™ encontra a se√ß√£o "Controle Geral" que permite controlar todas as 480 lumin√°rias de uma vez.</p>
        
        <ol class="step-list">
          <li class="step-item">
            <div class="step-title">Modo de Opera√ß√£o:</div>
            <div class="step-description">
              <strong>ü§ñ Autom√°tico:</strong> O sistema opera de forma aut√¥noma, com base nos hor√°rios programados e nas leituras do sensor de luminosidade. Ele ajusta o n√≠vel de ilumina√ß√£o conforme a necessidade do ambiente, sem interven√ß√£o do usu√°rio.  
            </div>
          </li>
          <li class="step-item">
            <div class="step-title">Modo de Opera√ß√£o:</div>
            <div class="step-description">
              <strong>üîß Manual:</strong> Permite que o usu√°rio controle diretamente o n√≠vel de ilumina√ß√£o da lumin√°ria, definindo a intensidade desejada, independentemente do agendamento ou da luz ambiente.
            </div>
          </li>
          <li class="step-item">
            <div class="step-title">Ajuste o Brilho (apenas no Modo Manual)</div>
            <div class="step-description">Use o controle deslizante ou digite um valor de 0% a 100%. Quanto maior o n√∫mero, mais forte a luz.</div>
          </li>
          <li class="step-item">
            <div class="step-title">Confirme as Mudan√ßas</div>
            <div class="step-description">O sistema aplica as altera√ß√µes automaticamente e mostra uma notifica√ß√£o de confirma√ß√£o.</div>
          </li>
        </ol>
      </div>

      <div class="demo-container">
        <div class="demo-title">üéÆ Demonstra√ß√£o Interativa - Controle Geral</div>
        <div class="demo-buttons">
          <button class="demo-btn manual" onclick="demonstrarModo('manual')">üîß Modo Manual</button>
          <button class="demo-btn automatico" onclick="demonstrarModo('automatico')">ü§ñ Modo Autom√°tico</button>
        </div>
        <div id="demoStatus" class="demo-status automatico">ü§ñ Sistema em Modo Autom√°tico</div>
        
        <div id="demoSliderContainer" class="demo-slider-container" style="display: none;">
          <div style="text-align: center; margin-bottom: 10px; font-weight: 600; color: #495057;">
            üí° Controle de Brilho Geral
          </div>
          <input type="range" class="demo-slider" id="demoSlider" min="0" max="100" value="50" onchange="atualizarDemoSlider(this.value)">
          <div class="demo-value" id="demoValue">50%</div>
        </div>
      </div>

      <div class="highlight-box warning">
        <div class="highlight-box-title">
          <span class="highlight-box-icon">‚ö†Ô∏è</span>
          Aten√ß√£o
        </div>
        <p>No Modo Manual, as lumin√°rias permanecem no estado que voc√™ definir at√© que voc√™ mude novamente ou volte para o Modo Autom√°tico. Certifique-se de que o modo escolhido √© adequado para o momento atual.</p>
      </div>
    </section>

    <!-- Se√ß√£o 4: Controle por Setores -->
    <section class="manual-section" id="controle-setores">
      <h2 class="section-title">
        <span class="section-icon">üè≠</span>
        Controle por Setores
      </h2>
      
      <div class="subsection">
        <h3 class="subsection-title">üéØ Controlando Setores Espec√≠ficos</h3>
        <p>Voc√™ pode controlar cada setor independentemente, o que √© muito √∫til quando apenas uma √°rea precisa de ajustes.</p>
        
        <ol class="step-list">
          <li class="step-item">
            <div class="step-title">Selecione o Setor</div>
            <div class="step-description">
              Use o menu suspenso para escolher:<br>
              ‚Ä¢ <strong>üöó Estacionamento</strong> (225 lumin√°rias)<br>
              ‚Ä¢ <strong>üè™ Loja</strong> (241 lumin√°rias)<br>
              ‚Ä¢ <strong>üì¶ Dep√≥sito</strong> (14 lumin√°rias)
            </div>
          </li>
          <li class="step-item">
            <div class="step-title">Defina o Modo do Setor</div>
            <div class="step-description">Cada setor pode ter seu pr√≥prio modo (Manual ou Autom√°tico), independente dos outros setores.</div>
          </li>
          <li class="step-item">
            <div class="step-title">Sobre os Modos do Setor</div>
            <div class="step-description"> No Modo Manual, voc√™ pode definir um brilho espec√≠fico para o setor selecionado. 
            Caso o setor esteja configurado em modo autom√°tico, ele ainda poder√° ser controlado pelo comando geral. 
            No entanto, se estiver em modo manual, os comandos gerais n√£o ter√£o efeito sobre ele.</div>
          </li>
          <li class="step-item">
            <div class="step-title">Ajuste o Brilho do Setor</div>
            <div class="step-description">No Modo Manual, voc√™ pode definir um brilho espec√≠fico apenas para o setor selecionado.</div>
          </li>
        </ol>
      </div>

      <div class="highlight-box tip">
        <div class="highlight-box-title">
          <span class="highlight-box-icon">üí°</span>
          Exemplo Pr√°tico
        </div>
        <p><strong>Situa√ß√£o:</strong> Durante o dia, voc√™ quer que o estacionamento funcione automaticamente, mas precisa deixar a loja com brilho reduzido para economia.<br><br>
        <strong>Solu√ß√£o:</strong> Deixe o estacionamento em "Modo Autom√°tico" e mude apenas a loja para "Modo Manual" com brilho baixo (exemplo: 30%).</p>
      </div>
    </section>

    <!-- Se√ß√£o 5: Agendamentos -->
    <section class="manual-section" id="agendamento">
      <h2 class="section-title">
        <span class="section-icon">‚è∞</span>
        Sistema de Agendamentos
      </h2>
      
      <div class="subsection">
        <h3 class="subsection-title">üìÖ Criando Agendamentos</h3>
        <p>O sistema permite programar hor√°rios autom√°ticos para ligar e desligar as lumin√°rias de cada setor.</p>
        
        <ol class="step-list">
          <li class="step-item">
            <div class="step-title">Sincronize o Rel√≥gio do Sistema</div>
            <div class="step-description">
              Clique no bot√£o "üîÑ Sincronizar" para ajustar o rel√≥gio interno com a hora atual do seu dispositivo. Isso garante que os agendamentos funcionem corretamente.
            </div>
          </li>
          <li class="step-item">
            <div class="step-title">Selecione o Setor para Agendar</div>
            <div class="step-description">Escolha qual setor receber√° o agendamento no menu suspenso da se√ß√£o "Agendamento Por Setores".</div>
          </li>
          <li class="step-item">
            <div class="step-title">Defina os Hor√°rios</div>
            <div class="step-description">
              ‚Ä¢ <strong>üåÖ Hor√°rio para Ligar:</strong> Quando as lumin√°rias devem acender automaticamente.<br>
              ‚Ä¢ <strong>üåô Hor√°rio para Desligar:</strong> Quando as lumin√°rias devem apagar automaticamente.<br>
              ‚Ä¢ <strong>üí° Brilho ao Ligar:</strong> Intensidade da luz quando ligar (0% a 100%).
            </div>
          </li>
          <li class="step-item">
            <div class="step-title">Confirme o Agendamento</div>
            <div class="step-description">Clique em "‚è∞ Agendar" para salvar. O sistema confirmar√° com uma mensagem de sucesso.</div>
          </li>
        </ol>
      </div>

      <div class="subsection">
        <h3 class="subsection-title">üìã Gerenciando Agendamentos Existentes</h3>
        <p>Na tabela "Agendamentos dos Setores", voc√™ pode ver e gerenciar todos os agendamentos:</p>
        <ul>
          <li><strong>‚ñ∂Ô∏è Ativar/‚è∏Ô∏è Desativar:</strong> Liga ou desliga um agendamento sem apag√°-lo</li>
          <li><strong>üóëÔ∏è Limpar:</strong> Remove completamente o agendamento do setor</li>
          <li><strong>Status:</strong> Mostra se o agendamento est√° ATIVO ou INATIVO</li>
        </ul>
      </div>

      <div class="highlight-box info">
        <div class="highlight-box-title">
          <span class="highlight-box-icon">‚ÑπÔ∏è</span>
          Como Funciona na Pr√°tica
        </div>
        <p><strong>Exemplo de Agendamento T√≠pico:</strong><br>
        ‚Ä¢ Setor: üöó Estacionamento<br>
        ‚Ä¢ Ligar: 18:00 com 80% de brilho<br>
        ‚Ä¢ Desligar: 06:00<br><br>
        <strong>Resultado:</strong> Todos os dias √†s 18:00, o estacionamento acende automaticamente com 80% de brilho e √†s 06:00 apaga automaticamente.</p>
      </div>

      <div class="highlight-box warning">
        <div class="highlight-box-title">
          <span class="highlight-box-icon">‚ö†Ô∏è</span>
          Importante sobre Agendamentos
        </div>
        <ul>
          <li>Os agendamentos s√≥ funcionam quando o setor est√° em <strong>Modo Autom√°tico</strong></li>
          <li>Se um setor estiver em <strong>Modo Manual</strong>, os agendamentos s√£o ignorados</li>
          <li>Sincronize o rel√≥gio regularmente para manter a precis√£o dos hor√°rios</li>
        </ul>
      </div>
    </section>

    <!-- Se√ß√£o 6: Visualiza√ß√£o -->
    <section class="manual-section" id="visualizacao">
      <h2 class="section-title">
        <span class="section-icon">üëÅÔ∏è</span>
        Tela de Visualiza√ß√£o
      </h2>
      
      <div class="subsection">
        <h3 class="subsection-title">üìä Monitoramento em Tempo Real</h3>
        <p>A tela de Visualiza√ß√£o mostra o status de todas as lumin√°rias em tempo real, atualizada automaticamente a cada 2 segundos.</p>
        
        <div class="demo-container">
          <div class="demo-title">üé® Legenda de Status das Lumin√°rias</div>
          <div style="display: flex; justify-content: space-around; flex-wrap: wrap; gap: 20px;">
            <div style="text-align: center;">
              <div style="width: 60px; height: 30px; background: linear-gradient(135deg, #10b981, #059669); border-radius: 8px; margin: 0 auto 8px; display: flex; align-items: center; justify-content: center; color: white; font-weight: 600; font-size: 12px;">85%</div>
              <strong>üü¢ Ligada</strong><br>
              <small>Funcionando normalmente</small>
            </div>
            <div style="text-align: center;">
              <div style="width: 60px; height: 30px; background: linear-gradient(135deg, #ef4444, #dc2626); border-radius: 8px; margin: 0 auto 8px; display: flex; align-items: center; justify-content: center; color: white; font-weight: 600; font-size: 12px;">0%</div>
              <strong>üî¥ Desligada</strong><br>
              <small>Apagada intencionalmente</small>
            </div>
            <div style="text-align: center;">
              <div style="width: 60px; height: 30px; background: linear-gradient(135deg, #f59e0b, #d97706); border-radius: 8px; margin: 0 auto 8px; display: flex; align-items: center; justify-content: center; color: white; font-weight: 600; font-size: 10px; animation: piscar 2s infinite;">S/COM</div>
              <strong>üü° Sem Comunica√ß√£o</strong><br>
              <small>Problema de conex√£o</small>
            </div>
          </div>
        </div>
      </div>

      <div class="subsection">
        <h3 class="subsection-title">üß≠ Navegando pelos Setores</h3>
        <ol class="step-list">
          <li class="step-item">
            <div class="step-title">Selecione o Setor</div>
            <div class="step-description">Use os bot√µes superiores: üöó Estacionamento, üè™ Loja ou üì¶ Dep√≥sito</div>
          </li>
          <li class="step-item">
            <div class="step-title">Escolha a √Årea (Estacionamento)</div>
            <div class="step-description">
              No estacionamento, voc√™ pode ver:<br>
              ‚Ä¢ <strong>üöó Geral:</strong> Colunas principais (200 lumin√°rias)<br>
              ‚Ä¢ <strong>üìç Lateral:</strong> √Årea lateral (25 lumin√°rias)
            </div>
          </li>
          <li class="step-item">
            <div class="step-title">Interprete os Contadores</div>
            <div class="step-description">
              Os n√∫meros mostram: <strong>ligadas/total</strong><br>
              Exemplo: "185/225" = 185 lumin√°rias ligadas de 225 totais
            </div>
          </li>
        </ol>
      </div>

      <div class="highlight-box tip">
        <div class="highlight-box-title">
          <span class="highlight-box-icon">üí°</span>
          Identificando Problemas
        </div>
        <p>Se voc√™ ver muitas lumin√°rias em <strong>üü° Amarelo (S/COM)</strong>, pode indicar:</p>
        <ul>
          <li>Problema na rede el√©trica local</li>
          <li>Falha de comunica√ß√£o</li>
          <li>Manuten√ß√£o necess√°ria</li>
        </ul>
        <p>Anote os locais afetados e informe ao t√©cnico respons√°vel.</p>
      </div>
    </section>

    <!-- Se√ß√£o 7: Consumo -->
    <section class="manual-section" id="consumo">
      <h2 class="section-title">
        <span class="section-icon">‚ö°</span>
        Monitoramento de Consumo
      </h2>
      <div class="subsection">
        <h3 class="subsection-title">üí∞ Configurando a Tarifa de Energia</h3>
        <p>Configure corretamente a tarifa para c√°lculos precisos dos custos:</p>
        
        <ol class="step-list">
          <li class="step-item">
            <div class="step-title">Encontre o Valor na Conta de Luz</div>
            <div class="step-description">
              Procure na sua conta de energia o valor em R$ por kWh. Geralmente fica entre R$ 0,40 e R$ 0,80 por kWh.
            </div>
          </li>
          <li class="step-item">
            <div class="step-title">Configure no Sistema</div>
            <div class="step-description">
              Na se√ß√£o "üí∞ Tarifa de Energia (R$/kWh)", digite o valor no campo e clique em "üíæ Salvar". O bot√£o mudar√° de cor para confirmar altera√ß√µes pendentes.
            </div>
          </li>
          <li class="step-item">
            <div class="step-title">Verifica√ß√£o Autom√°tica</div>
            <div class="step-description">
              O sistema recalcula automaticamente todos os custos hist√≥ricos e exibe o valor atual sendo usado nos c√°lculos abaixo do campo.
            </div>
          </li>
        </ol>
      </div>

      <div class="subsection">
        <h3 class="subsection-title">üéØ Filtros e Controles de Visualiza√ß√£o</h3>
        <p>Customize a visualiza√ß√£o dos dados conforme sua necessidade:</p>
        
        <ul>
          <li><strong>üìç Filtrar por Setor:</strong> Escolha entre Geral (todos), Estacionamento, Loja ou Dep√≥sito</li>
          <li><strong>üìÖ Per√≠odo:</strong> Selecione Hoje, Semana ou M√™s para diferentes an√°lises temporais</li>
          <li><strong>üîÑ Atualiza√ß√£o:</strong> Dados s√£o atualizados automaticamente a cada minuto</li>
        </ul>
      </div>

      <div class="subsection">
        <h3 class="subsection-title">üìä Dashboard de M√©tricas Reais</h3>
        <p>O painel exibe 4 m√©tricas baseadas exclusivamente em dados do ESP32:</p>
        <ul>
          <li><strong>üí° kWh Atual:</strong> Consumo real registrado pelo sistema</li>
          <li><strong>üí∞ Custo do Per√≠odo:</strong> Valor calculado com base na tarifa configurada</li>
          <li><strong>‚ö° Efici√™ncia Energ√©tica:</strong> Indicador de performance (ideal: acima de 80%)</li>
          <li><strong>‚è∞ Horas de Opera√ß√£o:</strong> Tempo real de funcionamento das lumin√°rias</li>
        </ul>
        
        <div class="highlight-box tip">
          <div class="highlight-box-title">
            <span class="highlight-box-icon">üìà</span>
            Interpretando as Tend√™ncias
          </div>
          <p>Cada m√©trica mostra tend√™ncias com √≠cones:</p>
          <ul>
            <li><strong>‚ÜóÔ∏è Verde:</strong> Aumento em rela√ß√£o ao per√≠odo anterior</li>
            <li><strong>‚ÜòÔ∏è Vermelho:</strong> Redu√ß√£o em rela√ß√£o ao per√≠odo anterior</li>
            <li><strong>‚û°Ô∏è Neutro:</strong> Valores est√°veis (varia√ß√£o menor que 1%)</li>
          </ul>
        </div>
      </div>

      <div class="subsection">
        <h3 class="subsection-title">üìà Gr√°ficos de An√°lise</h3>
        <p>Dois gr√°ficos mostram os dados reais de forma visual:</p>
        <ul>
          <li><strong>üìä Consumo por Hor√°rio:</strong> Gr√°fico de linha mostrando registros ao longo do tempo</li>
          <li><strong>ü•ß Distribui√ß√£o por Setor:</strong> Gr√°fico de pizza com percentual de consumo de cada √°rea</li>
        </ul>
      </div>

      <div class="subsection">
        <h3 class="subsection-title">üìã Tabela de Registros</h3>
        <p>A tabela "Registros de Consumo Hor√°rio" mostra <strong>exclusivamente dados</strong>:</p>
        
        <div class="demo-container">
          <div class="demo-title">üìä Colunas da Tabela Explicadas</div>
          <ul style="text-align: left;">
            <li><strong>‚è∞ Hor√°rio:</strong> Momento exato do registro</li>
            <li><strong>üè¢ Setor:</strong> √Årea monitorada</li>
            <li><strong>üí° Lumin√°rias Ativas:</strong> Quantidade funcionando</li>
            <li><strong>‚ö° Consumo (kWh):</strong> Energia real consumida</li>
            <li><strong>üí∞ Custo (R$):</strong> Valor calculado com a tarifa</li>
            <li><strong>üìä Efici√™ncia (%):</strong> Performance do sistema</li>
            <li><strong>üïê Status:</strong> Origem do registro</li>
          </ul>
        </div>

        <div class="highlight-box warning">
          <div class="highlight-box-title">
            <span class="highlight-box-icon">üîç</span>
            Status dos Registros
          </div>
          <ul>
            <li><strong>‚úÖ Registrado:</strong> Dado coletado automaticamente pelo ESP32</li>
            <li><strong>üîÑ Recuperado:</strong> Hor√°rio perdido, preenchido automaticamente pelo sistema</li>
          </ul>
          <p><strong>Sistema de Recupera√ß√£o:</strong> Se houver falhas na coleta (falta de energia, problemas de rede), o sistema detecta automaticamente e preenche as lacunas com base nos dados atuais dispon√≠veis.</p>
        </div>
      </div>

      <div class="subsection">
        <h3 class="subsection-title">üõ†Ô∏è Funcionalidades Avan√ßadas</h3>
        
        <ol class="step-list">
          <li class="step-item">
            <div class="step-title">üìó Exportar Excel</div>
            <div class="step-description">
              Baixa uma planilha com todos os registros reais do per√≠odo selecionado, incluindo status de cada registro.
            </div>
          </li>
          <li class="step-item">
            <div class="step-title">üîÑ Atualizar Dados</div>
            <div class="step-description">
              For√ßa uma nova coleta de dados do ESP32, √∫til quando voc√™ suspeita que h√° novos registros dispon√≠veis.
            </div>
          </li>
          <li class="step-item">
            <div class="step-title">üóëÔ∏è Resetar Hist√≥rico</div>
            <div class="step-description">
              <strong>CUIDADO:</strong> Apaga completamente todo o hist√≥rico de dados. Use apenas quando necess√°rio reiniciar a coleta do zero.
            </div>
          </li>
        </ol>
      </div>

      <div class="highlight-box tip">
        <div class="highlight-box-title">
          <span class="highlight-box-icon">üí°</span>
          Dicas para An√°lise Eficiente
        </div>
        <ul>
          <li><strong>Monitore Regularmente:</strong> Verifique os dados semanalmente para identificar padr√µes</li>
          <li><strong>Compare Setores:</strong> Use o filtro por setor para identificar √°reas com maior consumo</li>
          <li><strong>Acompanhe Efici√™ncia:</strong> Valores abaixo de 70% podem indicar problemas t√©cnicos</li>
          <li><strong>Analise Tend√™ncias:</strong> Use as setas coloridas para identificar aumentos ou redu√ß√µes</li>
          <li><strong>Exporte Dados:</strong> Mantenha backups mensais dos dados para an√°lises hist√≥ricas</li>
          <li><strong>Verifique Recupera√ß√µes:</strong> Muitos registros "üîÑ Recuperados" podem indicar problemas de rede</li>
        </ul>
      </div>

      <div class="highlight-box warning">
        <div class="highlight-box-title">
          <span class="highlight-box-icon">‚ö†Ô∏è</span>
          Limita√ß√µes do Sistema de Dados
        </div>
        <ul>
          <li><strong>Depend√™ncia do ESP32:</strong> Sem comunica√ß√£o com o hardware, n√£o h√° novos dados</li>
          <li><strong>Coleta Hor√°ria:</strong> Dados s√£o registrados a cada hora cheia (ex: 14:00, 15:00)</li>
          <li><strong>Faz Um Previs√£o:</strong> O sistema faz estimativas - n√£o temos medi√ß√£o real da lumin√°ria</li>
          <li><strong>Reset Irrevers√≠vel:</strong> Dados apagados pelo reset n√£o podem ser recuperados</li>
        </ul>
      </div>
    </section>

    <!-- Se√ß√£o 8: Banco de Dados -->
    <section class="manual-section" id="banco-dados">
      <h2 class="section-title">
        <span class="section-icon">üóÑÔ∏è</span>
        Configura√ß√£o do Banco de Dados
      </h2>
      
      <p>O Sistema Viza utiliza um servidor Python separado para armazenar e gerenciar dados hist√≥ricos de consumo. Esta se√ß√£o explica como configurar e manter o banco de dados do sistema.</p>

      <div class="highlight-box info">
        <div class="highlight-box-title">
          <span class="highlight-box-icon">‚ÑπÔ∏è</span>
          Sobre o Banco de Dados
        </div>
        <p>O banco de dados √© um servidor Python independente que roda em paralelo ao sistema ESP32. Ele coleta, armazena e processa dados de consumo energ√©tico para an√°lises hist√≥ricas e relat√≥rios.</p>
      </div>

      <div class="subsection">
        <h3 class="subsection-title">üåê Acessando a Configura√ß√£o</h3>
        <p>Para acessar as configura√ß√µes do banco de dados:</p>
        
        <ol class="step-list">
          <li class="step-item">
            <div class="step-title">Navegue para a Tela de Consumo</div>
            <div class="step-description">Na tela principal de "üìä Consumo De Energia"</div>
          </li>
          <li class="step-item">
            <div class="step-title">Clique em "Configura√ß√£o Banco De Dados"</div>
            <div class="step-description">Use o bot√£o cinza "üõ†Ô∏è Configura√ß√£o Banco De Dados" na parte inferior</div>
          </li>
          <li class="step-item">
            <div class="step-title">Verifique o Status</div>
            <div class="step-description">A barra de status mostra o estado atual: Banco, Backup, Limpeza e Scheduler</div>
          </li>
        </ol>
      </div>

      <div class="subsection">
        <h3 class="subsection-title">‚öôÔ∏è Configura√ß√£o Inicial</h3>
        
        <div class="sistema-container">
          <div class="sistema-card">
            <div class="sistema-title">
              <span style="font-size: 1.5em;">üñ•Ô∏è</span>
              Configura√ß√£o do Servidor
            </div>
            
            <ol class="step-list">
              <li class="step-item">
                <div class="step-title">Configure o IP do Servidor</div>
                <div class="step-description">
                  <strong>IP Padr√£o:</strong> 192.168.4.2<br>
                  Digite o endere√ßo IP onde o servidor Python est√° rodando
                </div>
              </li>
              <li class="step-item">
                <div class="step-title">Configure a Porta</div>
                <div class="step-description">
                  <strong>Porta Padr√£o:</strong> 5000<br>
                  Mantenha 5000 ou use a porta configurada pelo administrador
                </div>
              </li>
              <li class="step-item">
                <div class="step-title">Crie o Banco (Primeira Vez)</div>
                <div class="step-description">
                  Clique em "üÜï Criar Banco" para inicializar o banco de dados
                </div>
              </li>
              <li class="step-item">
                <div class="step-title">Inicie a Conex√£o</div>
                <div class="step-description">
                  Clique em "‚ñ∂Ô∏è Iniciar Banco" para conectar ao servidor
                </div>
              </li>
            </ol>
          </div>
        </div>
      </div>

      <div class="subsection">
        <h3 class="subsection-title">üíæ Sistema de Backup</h3>
        <p>Configure backups autom√°ticos para proteger seus dados hist√≥ricos:</p>
        
        <div class="tab-container">
          <div class="tab-buttons">
            <div class="tab-button active" onclick="showTab('backup-config')">‚öôÔ∏è Configura√ß√£o</div>
            <div class="tab-button" onclick="showTab('backup-manual')">üîß Backup Manual</div>
            <div class="tab-button" onclick="showTab('backup-restaurar')">üì• Restaurar</div>
          </div>

          <div id="tab-backup-config" class="tab-content active">
            <div class="sistema-title">
              <span style="font-size: 1.5em;">‚öôÔ∏è</span>
              Configura√ß√£o de Backup Autom√°tico
            </div>

            <ol class="step-list">
              <li class="step-item">
                <div class="step-title">Ativar Backup Autom√°tico</div>
                <div class="step-description">Use a chave deslizante para "Habilitado"</div>
              </li>
              <li class="step-item">
                <div class="step-title">Definir Frequ√™ncia</div>
                <div class="step-description">
                  ‚Ä¢ <strong>üìÖ Di√°rio:</strong> Backup todos os dias<br>
                  ‚Ä¢ <strong>üìà Semanal:</strong> Uma vez por semana (recomendado)<br>
                  ‚Ä¢ <strong>üìÜ Mensal:</strong> Uma vez por m√™s
                </div>
              </li>
              <li class="step-item">
                <div class="step-title">Configurar Hor√°rio</div>
                <div class="step-description">
                  <strong>Padr√£o:</strong> 02:00 (madrugada)<br>
                  Escolha um hor√°rio de baixo uso do sistema
                </div>
              </li>
            </ol>
          </div>

          <div id="tab-backup-manual" class="tab-content">
            <div class="sistema-title">
              <span style="font-size: 1.5em;">üîß</span>
              Fazendo Backup Manual
            </div>

            <ol class="step-list">
              <li class="step-item">
                <div class="step-title">Verificar Conex√£o</div>
                <div class="step-description">Certifique-se que o status mostra "üü¢ Banco: Conectado"</div>
              </li>
              <li class="step-item">
                <div class="step-title">Executar Backup</div>
                <div class="step-description">Clique em "üíæ Fazer Backup Agora"</div>
              </li>
              <li class="step-item">
                <div class="step-title">Aguardar Confirma√ß√£o</div>
                <div class="step-description">O sistema mostrar√° o nome do arquivo gerado</div>
              </li>
            </ol>

            <div class="highlight-box tip">
              <div class="highlight-box-title">
                <span class="highlight-box-icon">üí°</span>
                Quando Fazer Backup Manual
              </div>
              <ul>
                <li>Antes de mudan√ßas importantes no sistema</li>
                <li>Ao final de per√≠odos cr√≠ticos (m√™s, trimestre)</li>
                <li>Antes de limpezas autom√°ticas</li>
                <li>Como precau√ß√£o antes de manuten√ß√µes</li>
              </ul>
            </div>
          </div>

          <div id="tab-backup-restaurar" class="tab-content">
            <div class="sistema-title">
              <span style="font-size: 1.5em;">üì•</span>
              Restaurando Backup
            </div>

            <div class="highlight-box danger">
              <div class="highlight-box-title">
                <span class="highlight-box-icon">‚ö†Ô∏è</span>
                ATEN√á√ÉO: Opera√ß√£o Irrevers√≠vel
              </div>
              <p>Restaurar um backup substitui TODOS os dados atuais. Esta opera√ß√£o n√£o pode ser desfeita!</p>
            </div>

            <ol class="step-list">
              <li class="step-item">
                <div class="step-title">Confirmar Necessidade</div>
                <div class="step-description">Certifique-se que realmente precisa restaurar dados antigos</div>
              </li>
              <li class="step-item">
                <div class="step-title">Obter Nome do Arquivo</div>
                <div class="step-description">Localize o nome exato do arquivo de backup (ex: backup_2024_01_15.db)</div>
              </li>
              <li class="step-item">
                <div class="step-title">Executar Restaura√ß√£o</div>
                <div class="step-description">
                  1. Clique em "üì• Restaurar Backup"<br>
                  2. Digite o nome do arquivo quando solicitado<br>
                  3. Confirme a opera√ß√£o
                </div>
              </li>
              <li class="step-item">
                <div class="step-title">Verificar Resultado</div>
                <div class="step-description">Aguarde a confirma√ß√£o e verifique se os dados foram restaurados corretamente</div>
              </li>
            </ol>
          </div>
        </div>
      </div>

      <div class="subsection">
        <h3 class="subsection-title">üßπ Limpeza Autom√°tica</h3>
        <p>Configure a limpeza autom√°tica para otimizar o desempenho e espa√ßo do banco:</p>
        
        <ol class="step-list">
          <li class="step-item">
            <div class="step-title">Ativar Limpeza Autom√°tica</div>
            <div class="step-description">Use a chave deslizante para "Habilitado"</div>
          </li>
          <li class="step-item">
            <div class="step-title">Configurar Frequ√™ncia</div>
            <div class="step-description">
              ‚Ä¢ <strong>üåÖ Di√°rio:</strong> Todo dia (para sistemas com muitos dados)<br>
              ‚Ä¢ <strong>üìä A cada 3 dias:</strong> Equilibrio entre performance e manuten√ß√£o<br>
              ‚Ä¢ <strong>üìà Semanal:</strong> Uma vez por semana (recomendado)<br>
              ‚Ä¢ <strong>üìã Quinzenal:</strong> A cada 15 dias<br>
              ‚Ä¢ <strong>üìÜ Mensal:</strong> Uma vez por m√™s
            </div>
          </li>
          <li class="step-item">
            <div class="step-title">Definir Per√≠odo de Reten√ß√£o</div>
            <div class="step-description">
              Escolha quantos dados manter:<br>
              ‚Ä¢ <strong>7-15 dias:</strong> Para testes e sistemas tempor√°rios<br>
              ‚Ä¢ <strong>30 dias:</strong> Para an√°lises mensais (recomendado)<br>
              ‚Ä¢ <strong>60-90 dias:</strong> Para an√°lises trimestrais<br>
              ‚Ä¢ <strong>1 ano:</strong> Para an√°lises anuais e compliance
            </div>
          </li>
        </ol>

        <div class="highlight-box warning">
          <div class="highlight-box-title">
            <span class="highlight-box-icon">‚ö†Ô∏è</span>
            Sobre a Limpeza Autom√°tica
          </div>
          <p>A limpeza remove permanentemente dados antigos. Configure per√≠odos adequados √†s suas necessidades de an√°lise hist√≥rica. Fa√ßa backups antes de configurar limpezas agressivas.</p>
        </div>
      </div>

      <div class="subsection">
        <h3 class="subsection-title">üîß Limpeza Manual</h3>
        <p>Execute limpezas pontuais quando necess√°rio:</p>
        
        <ol class="step-list">
          <li class="step-item">
            <div class="step-title">Avaliar Necessidade</div>
            <div class="step-description">
              Execute limpeza manual se:<br>
              ‚Ä¢ O banco est√° muito lento<br>
              ‚Ä¢ H√° problemas de espa√ßo em disco<br>
              ‚Ä¢ Dados antigos n√£o s√£o mais relevantes
            </div>
          </li>
          <li class="step-item">
            <div class="step-title">Fazer Backup Preventivo</div>
            <div class="step-description">SEMPRE fa√ßa backup antes de limpezas manuais</div>
          </li>
          <li class="step-item">
            <div class="step-title">Executar Limpeza</div>
            <div class="step-description">
              1. Clique em "üßπ Executar Limpeza Agora"<br>
              2. Confirme a opera√ß√£o<br>
              3. Aguarde o relat√≥rio de registros removidos
            </div>
          </li>
        </ol>
      </div>

      <div class="subsection">
        <h3 class="subsection-title">üìä Monitoramento de Status</h3>
        <p>A barra de status na parte superior mostra 4 indicadores importantes:</p>
        
        <div class="especificacoes-tabela">
          <table>
            <thead>
              <tr>
                <th>Indicador</th>
                <th>Status Saud√°vel</th>
                <th>Status Problem√°tico</th>
                <th>A√ß√£o Necess√°ria</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>üóÑÔ∏è Banco</strong></td>
                <td>üü¢ Conectado</td>
                <td>üî¥ Desconectado</td>
                <td>Verificar IP, porta e servidor Python</td>
              </tr>
              <tr>
                <td><strong>üíæ Backup</strong></td>
                <td>‚úÖ Ativo</td>
                <td>üíæ Inativo</td>
                <td>Configurar backup autom√°tico</td>
              </tr>
              <tr>
                <td><strong>üßπ Limpeza</strong></td>
                <td>üßπ Ativa</td>
                <td>üßπ Inativa</td>
                <td>Configurar limpeza autom√°tica</td>
              </tr>
              <tr>
                <td><strong>üîÑ Scheduler</strong></td>
                <td>üü¢ Ativo</td>
                <td>üî¥ Parado</td>
                <td>Reiniciar servidor Python</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <div class="highlight-box tip">
        <div class="highlight-box-title">
          <span class="highlight-box-icon">üí°</span>
          Boas Pr√°ticas para o Banco de Dados
        </div>
        <ul>
          <li><strong>Backup Regular:</strong> Configure backup semanal autom√°tico</li>
          <li><strong>Monitoramento:</strong> Verifique status semanalmente</li>
          <li><strong>Limpeza Planejada:</strong> Configure reten√ß√£o adequada √†s necessidades</li>
          <li><strong>Manuten√ß√£o Preventiva:</strong> Teste restaura√ß√£o de backups periodicamente</li>
          <li><strong>Documenta√ß√£o:</strong> Anote mudan√ßas importantes de configura√ß√£o</li>
          <li><strong>Acesso Controlado:</strong> Apenas administradores devem alterar configura√ß√µes</li>
        </ul>
      </div>

      <div class="highlight-box danger">
        <div class="highlight-box-title">
          <span class="highlight-box-icon">üö®</span>
          Situa√ß√µes de Emerg√™ncia
        </div>
        <p><strong>Se todos os dados forem perdidos:</strong></p>
        <ol>
          <li>N√ÉO entre em p√¢nico - o sistema de ilumina√ß√£o continua funcionando</li>
          <li>Pare imediatamente qualquer opera√ß√£o de limpeza ou restaura√ß√£o</li>
          <li>Contate o suporte t√©cnico imediatamente</li>
          <li>Se houver backup recente, aguarde orienta√ß√£o para restaura√ß√£o</li>
          <li>O sistema come√ßar√° a coletar novos dados automaticamente</li>
        </ol>
      </div>
    </section>

    <!-- Se√ß√£o 9: Esquemas de Liga√ß√£o El√©trica -->
    <section class="manual-section" id="esquema-ligacao">
      <h2 class="section-title">
        <span class="section-icon">‚ö°</span>
        Esquemas de Liga√ß√£o El√©trica
      </h2>
      
      <p>O Sistema de Ilumina√ß√£o Viza √© composto por dois tipos de ESP32 que trabalham em conjunto: um <strong>MESTRE</strong> (interface e controle) e um <strong>ESCRAVO</strong> (sensores e lumin√°rias).</p>

      <div class="tab-container">
        <div class="tab-buttons">
          <div class="tab-button active" onclick="showTab('mestre')">üì± ESP32 MESTRE</div>
          <div class="tab-button" onclick="showTab('escravo')">üåû ESP32 ESCRAVO</div>
          <div class="tab-button" onclick="showTab('comunicacao')">üì° Comunica√ß√£o</div>
        </div>

        <!-- TAB: ESP32 MESTRE -->
        <div id="tab-mestre" class="tab-content active">
          <div class="sistema-title">
            <span style="font-size: 1.5em;">üì±</span>
            ESP32 MESTRE - Interface e Controle
          </div>

          <div class="pin-diagram">
            <div class="pin-esp32">ESP32 MESTRE - Pinagem Utilizada</div>
            
            <div class="pin-connection">
              <span class="pin-left">VIN</span>
              <span>‚Üê‚Üí</span>
              <span class="pin-right">Fonte 5V (+) + RTC VCC</span>
            </div>
            
            <div class="pin-connection">
              <span class="pin-left">GND</span>
              <span>‚Üê‚Üí</span>
              <span class="pin-right">Fonte 5V (-) + RTC GND</span>
            </div>
            
            <div class="pin-connection">
              <span class="pin-left">GPIO25</span>
              <span>‚Üê‚Üí</span>
              <span class="pin-right">RTC SDA (Serial Data)</span>
            </div>
            
            <div class="pin-connection">
              <span class="pin-left">GPIO26</span>
              <span>‚Üê‚Üí</span>
              <span class="pin-right">RTC SCL (Serial Clock)</span>
            </div>
          </div>

          <div class="componentes-grid">
            <div class="componente-item">
              <div class="componente-icon">üì±</div>
              <div class="componente-info">
                <h4>ESP32 MESTRE</h4>
                <p><strong>Fun√ß√µes:</strong> Interface web, agendamentos, comunica√ß√£o com escravo via WiFi/ESP-NOW. Gerencia toda a l√≥gica do sistema.</p>
              </div>
            </div>
            
            <div class="componente-item">
              <div class="componente-icon">üïí</div>
              <div class="componente-info">
                <h4>M√≥dulo RTC DS3231</h4>
                <p><strong>Comunica√ß√£o I2C:</strong> Mant√©m hor√°rio preciso com backup de bateria. Endere√ßo 0x68, precis√£o ¬±2ppm.</p>
              </div>
            </div>
            
            <div class="componente-item">
              <div class="componente-icon">‚ö°</div>
              <div class="componente-info">
                <h4>Fonte 5V (Mestre)</h4>
                <p><strong>Alimenta√ß√£o:</strong> 220V AC ‚Üí 5V DC para ESP32 e RTC. Isolada e estabilizada.</p>
              </div>
            </div>
            
            <div class="componente-item">
              <div class="componente-icon">üîã</div>
              <div class="componente-info">
                <h4>Bateria Backup CR2032</h4>
                <p><strong>Backup:</strong> Mant√©m RTC funcionando mesmo sem energia el√©trica. Dura√ß√£o: 10+ anos.</p>
              </div>
            </div>
          </div>
        </div>

        <!-- TAB: ESP32 ESCRAVO -->
        <div id="tab-escravo" class="tab-content">
          <div class="sistema-title">
            <span style="font-size: 1.5em;">üåû</span>
            ESP32 ESCRAVO - Sensores e Controle das Lumin√°rias
          </div>

          <div class="pin-diagram">
            <div class="pin-esp32">ESP32 ESCRAVO - Pinagem Utilizada</div>
            
            <div class="pin-connection">
              <span class="pin-left">VIN</span>
              <span>‚Üê‚Üí</span>
              <span class="pin-right">Fonte 5V (+) + LDR Terminal 1</span>
            </div>
            
            <div class="pin-connection">
              <span class="pin-left">GND</span>
              <span>‚Üê‚Üí</span>
              <span class="pin-right">Fonte 5V (-) + Resistor 220Œ© + Lumin√°rias (-)</span>
            </div>
            
            <div class="pin-connection">
              <span class="pin-left">GPIO35</span>
              <span>‚Üê‚Üí</span>
              <span class="pin-right">LDR Terminal 2 + Resistor 220Œ©</span>
            </div>
            
            <div class="pin-connection">
              <span class="pin-left">GPIO25</span>
              <span>‚Üê‚Üí</span>
              <span class="pin-right">TODAS as Lumin√°rias (+) - 480 unidades</span>
            </div>
          </div>

          <div class="componentes-grid">
            <div class="componente-item">
              <div class="componente-icon">üåû</div>
              <div class="componente-info">
                <h4>Sensor LDR + Resistor 220Œ©</h4>
                <p><strong>Divisor de tens√£o:</strong> Detecta luz ambiente automaticamente. LDR varia de 1kŒ© (dia) a 10kŒ© (noite).</p>
              </div>
            </div>
            
            <div class="componente-item">
              <div class="componente-icon">üí°</div>
              <div class="componente-info">
                <h4>480 Lumin√°rias LED</h4>
                <p><strong>Controle unificado:</strong> Todas controladas simultaneamente via GPIO25 (PWM). Estacionamento: 225x50W, Loja: 241x30W, Dep√≥sito: 14x40W.</p>
              </div>
            </div>
            
            <div class="componente-item">
              <div class="componente-icon">üì±</div>
              <div class="componente-info">
                <h4>ESP32 ESCRAVO</h4>
                <p><strong>Fun√ß√µes:</strong> Leitura do sensor LDR, controle PWM das lumin√°rias, monitoramento de consumo, comunica√ß√£o com mestre.</p>
              </div>
            </div>
            
            <div class="componente-item">
              <div class="componente-icon">‚ö°</div>
              <div class="componente-info">
                <h4>Fonte 5V (Escravo)</h4>
                <p><strong>Alimenta√ß√£o:</strong> 220V AC ‚Üí 5V DC apenas para ESP32. Lumin√°rias alimentadas direto da rede 220V.</p>
              </div>
            </div>
          </div>

          <div class="highlight-box info">
            <div class="highlight-box-title">
              <span class="highlight-box-icon">üí°</span>
              Funcionamento do Circuito LDR
            </div>
            <p><strong>Divisor de tens√£o:</strong> O LDR e resistor 220Œ© formam um divisor que varia a tens√£o no GPIO35 conforme a luz:</p>
            <ul>
              <li><strong>Dia (muita luz):</strong> LDR ‚âà 1kŒ© ‚Üí GPIO35 l√™ ~0.9V (valor alto)</li>
              <li><strong>Noite (pouca luz):</strong> LDR ‚âà 10kŒ© ‚Üí GPIO35 l√™ ~0.1V (valor baixo)</li>
              <li><strong>Resolu√ß√£o:</strong> 12 bits (0-4095) para detec√ß√£o precisa</li>
            </ul>
          </div>
        </div>

        <!-- TAB: COMUNICA√á√ÉO -->
        <div id="tab-comunicacao" class="tab-content">
          <div class="sistema-title">
            <span style="font-size: 1.5em;">üì°</span>
            Comunica√ß√£o entre MESTRE e ESCRAVO
          </div>

          <div class="componentes-grid">
            <div class="componente-item">
              <div class="componente-icon">üåê</div>
              <div class="componente-info">
                <h4>WiFi/ESP-NOW</h4>
                <p><strong>Protocolo:</strong> Comunica√ß√£o wireless direta entre os ESP32. Baixa lat√™ncia e alta confiabilidade.</p>
              </div>
            </div>
            
            <div class="componente-item">
              <div class="componente-icon">üì§</div>
              <div class="componente-info">
                <h4>Comandos (Mestre ‚Üí Escravo)</h4>
                <p><strong>Controle:</strong> Liga/desliga, ajuste de brilho, modo autom√°tico/manual, solicita√ß√£o de status.</p>
              </div>
            </div>
            
            <div class="componente-item">
              <div class="componente-icon">üì•</div>
              <div class="componente-info">
                <h4>Feedback (Escravo ‚Üí Mestre)</h4>
                <p><strong>Monitoramento:</strong> Status das lumin√°rias, consumo energ√©tico, leitura do sensor LDR, confirma√ß√µes.</p>
              </div>
            </div>
            
            <div class="componente-item">
              <div class="componente-icon">üîÑ</div>
              <div class="componente-info">
                <h4>Sincroniza√ß√£o</h4>
                <p><strong>Tempo:</strong> Mestre sincroniza hor√°rio com escravo via RTC para agendamentos precisos.</p>
              </div>
            </div>
          </div>

          <h4>üîÑ Fluxo de Funcionamento:</h4>
          <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin: 15px 0;">
            <ol>
              <li><strong>Usu√°rio:</strong> Acessa interface web no ESP32 Mestre</li>
              <li><strong>Processamento:</strong> Mestre consulta RTC e processa comando</li>
              <li><strong>Transmiss√£o:</strong> Comando enviado via WiFi/ESP-NOW para Escravo</li>
              <li><strong>Execu√ß√£o:</strong> Escravo controla lumin√°rias e sensores</li>
              <li><strong>Resposta:</strong> Escravo envia status de volta para Mestre</li>
              <li><strong>Interface:</strong> Dados atualizados na interface web</li>
            </ol>
          </div>
        </div>
      </div>

      <div class="subsection">
        <h3 class="subsection-title">üìã Especifica√ß√µes T√©cnicas Gerais</h3>
        <div class="especificacoes-tabela">
          <table>
            <thead>
              <tr>
                <th>Sistema</th>
                <th>Componente</th>
                <th>Especifica√ß√£o</th>
                <th>Fun√ß√£o</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td rowspan="3"><strong>MESTRE</strong></td>
                <td>ESP32</td>
                <td>240MHz, WiFi, Servidor Web</td>
                <td>Interface e comunica√ß√£o</td>
              </tr>
              <tr>
                <td>RTC DS3231</td>
                <td>I2C, ¬±2ppm, backup CR2032</td>
                <td>Controle de tempo</td>
              </tr>
              <tr>
                <td>Fonte 5V</td>
                <td>220V‚Üí5V, 3A</td>
                <td>Alimenta√ß√£o Mestre + RTC</td>
              </tr>
              <tr>
                <td rowspan="4"><strong>ESCRAVO</strong></td>
                <td>ESP32</td>
                <td>240MHz, PWM, ADC 12-bit</td>
                <td>Controle lumin√°rias + sensores</td>
              </tr>
              <tr>
                <td>Sensor LDR</td>
                <td>1kŒ©-10kŒ©, fotoresistor</td>
                <td>Detec√ß√£o luz ambiente</td>
              </tr>
              <tr>
                <td>480 Lumin√°rias LED</td>
                <td>88.50W, 220V AC</td>
                <td>Ilumina√ß√£o dos setores</td>
              </tr>
              <tr>
                <td>Fonte 5V</td>
                <td>220V‚Üí5V, 3A</td>
                <td>Alimenta√ß√£o Escravo</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <div class="highlight-box warning">
        <div class="highlight-box-title">
          <span class="highlight-box-icon">‚ö†Ô∏è</span>
          Seguran√ßa na Instala√ß√£o
        </div>
        <p><strong>IMPORTANTE:</strong> Sempre desligue a alimenta√ß√£o 220V antes de fazer qualquer conex√£o. Use EPIs adequados e siga as normas NR-10.</p>
        <ul>
          <li>‚úÖ Verificar tens√µes com mult√≠metro</li>
          <li>‚úÖ Testar continuidade antes de energizar</li>
          <li>‚úÖ Instalar prote√ß√µes (disjuntores, fus√≠veis)</li>
          <li>‚úÖ Isolar adequadamente todas as conex√µes</li>
          <li>‚úÖ Documentar todas as modifica√ß√µes</li>
        </ul>
      </div>
    </section>

    <!-- Se√ß√£o 10: Solu√ß√£o de Problemas -->
    <section class="manual-section" id="troubleshooting">
      <h2 class="section-title">
        <span class="section-icon">üîß</span>
        Solu√ß√£o de Problemas
      </h2>
      
      <div class="troubleshoot-item">
        <div class="troubleshoot-icon">üî¥</div>
        <div class="troubleshoot-content">
          <h4>Sistema Mostra "Offline" no Canto Superior</h4>
          <p><strong>Solu√ß√£o:</strong> Verifique sua conex√£o com a internet. Recarregue a p√°gina (F5). Se persistir, verifique se o equipamento do sistema est√° ligado e conectado √† rede.</p>
        </div>
      </div>

      <div class="troubleshoot-item">
        <div class="troubleshoot-icon">‚ö†Ô∏è</div>
        <div class="troubleshoot-content">
          <h4>Lumin√°rias N√£o Respondem aos Comandos</h4>
          <p><strong>Solu√ß√£o:</strong> Verifique se o setor est√° em "Modo Manual". Se estiver em "Modo Autom√°tico", os comandos manuais n√£o funcionam. Mude para "Modo Manual" primeiro.</p>
        </div>
      </div>

      <div class="troubleshoot-item">
        <div class="troubleshoot-icon">üü°</div>
        <div class="troubleshoot-content">
          <h4>Muitas Lumin√°rias em "Sem Comunica√ß√£o"</h4>
          <p><strong>Solu√ß√£o:</strong> Pode ser problema tempor√°rio de rede. Aguarde alguns minutos. Se persistir, anote quais setores est√£o afetados e contate o suporte t√©cnico.</p>
        </div>
      </div>

      <div class="troubleshoot-item">
        <div class="troubleshoot-icon">‚è∞</div>
        <div class="troubleshoot-content">
          <h4>Agendamentos N√£o Funcionam</h4>
          <p><strong>Solu√ß√£o:</strong> 1) Verifique se o setor est√° em "Modo Autom√°tico". 2) Sincronize o rel√≥gio do sistema. 3) Confirme se o agendamento est√° marcado como "ATIVO".</p>
        </div>
      </div>

      <div class="troubleshoot-item">
        <div class="troubleshoot-icon">üìä</div>
        <div class="troubleshoot-content">
          <h4>Tabela de Consumo Vazia ou "Nenhum Registro Encontrado"</h4>
          <p><strong>Solu√ß√£o:</strong> Sistema novo demora 1 hora para primeira coleta. Se sistema j√° antigo: 1) Clique "üîÑ Atualizar Dados". 2) Verifique status de conex√£o. 3) Aguarde pr√≥xima coleta autom√°tica (hor√°rio cheio).</p>
        </div>
      </div>

      <div class="troubleshoot-item">
        <div class="troubleshoot-icon">üîÑ</div>
        <div class="troubleshoot-content">
          <h4>Muitos Registros Aparecem como "Recuperado"</h4>
          <p><strong>Solu√ß√£o:</strong> Indica problemas de comunica√ß√£o intermitentes. Verifique estabilidade da rede, cabo de internet e alimenta√ß√£o do ESP32. Se persistir, contate suporte t√©cnico.</p>
        </div>
      </div>

      <div class="troubleshoot-item">
        <div class="troubleshoot-icon">‚ö°</div>
        <div class="troubleshoot-content">
          <h4>Efici√™ncia Energ√©tica Muito Baixa (abaixo de 50%)</h4>
          <p><strong>Solu√ß√£o:</strong> Pode indicar: 1) Lumin√°rias defeituosas. 2) Problemas na rede el√©trica. 3) Configura√ß√£o incorreta. Anote os hor√°rios afetados e contate manuten√ß√£o t√©cnica.</p>
        </div>
      </div>

      <div class="troubleshoot-item">
        <div class="troubleshoot-icon">üîå</div>
        <div class="troubleshoot-content">
          <h4>Falha na Comunica√ß√£o ESP32 Mestre ‚Üî Escravo</h4>
          <p><strong>Solu√ß√£o:</strong> 1) Verifique alimenta√ß√£o de ambos os ESP32. 2) Confirme se est√£o na mesma rede WiFi. 3) Reinicie ambos os dispositivos. 4) Verifique se n√£o h√° interfer√™ncia de outros equipamentos 2.4GHz.</p>
        </div>
      </div>

      <div class="troubleshoot-item">
        <div class="troubleshoot-icon">üåû</div>
        <div class="troubleshoot-content">
          <h4>Sensor LDR N√£o Detecta Mudan√ßas de Luz</h4>
          <p><strong>Solu√ß√£o:</strong> 1) Limpe o sensor LDR. 2) Verifique conex√µes GPIO35 e resistor 220Œ©. 3) Teste cobrindo/descobrindo o sensor. 4) Substitua LDR ou resistor se necess√°rio.</p>
        </div>
      </div>
    </section>

    <!-- Se√ß√£o 11: FAQ -->
    <section class="manual-section" id="faq">
      <h2 class="section-title">
        <span class="section-icon">‚ùì</span>
        Perguntas Frequentes
      </h2>
      
      <div class="faq-item">
        <button class="faq-question" onclick="toggleFaq(this)">
          Posso usar o sistema no meu celular?
          <span class="faq-icon">‚ñº</span>
        </button>
        <div class="faq-answer">
          <p>Sim! O sistema funciona perfeitamente em celulares, tablets e computadores. Basta acessar pelo navegador. Voc√™ pode at√© instalar como um aplicativo clicando no bot√£o de instala√ß√£o que aparece no canto inferior direito.</p>
        </div>
      </div>

      <div class="faq-item">
        <button class="faq-question" onclick="toggleFaq(this)">
          O que acontece se eu fechar o navegador?
          <span class="faq-icon">‚ñº</span>
        </button>
        <div class="faq-answer">
          <p>Nada! O sistema continua funcionando normalmente no servidor. Fechar o navegador s√≥ fecha a sua visualiza√ß√£o. Os agendamentos e configura√ß√µes permanecem ativos.</p>
        </div>
      </div>

      <div class="faq-item">
        <button class="faq-question" onclick="toggleFaq(this)">
          V√°rias pessoas podem usar o sistema ao mesmo tempo?
          <span class="faq-icon">‚ñº</span>
        </button>
        <div class="faq-answer">
          <p>Sim! M√∫ltiplas pessoas podem acessar simultaneamente. Por√©m, tenha cuidado com altera√ß√µes conflitantes. √â recomendado que apenas uma pessoa fa√ßa altera√ß√µes por vez.</p>
        </div>
      </div>

      <div class="faq-item">
        <button class="faq-question" onclick="toggleFaq(this)">
          Como sei se minhas altera√ß√µes foram aplicadas?
          <span class="faq-icon">‚ñº</span>
        </button>
        <div class="faq-answer">
          <p>O sistema sempre mostra notifica√ß√µes (toasts) no canto superior direito confirmando as a√ß√µes. Mensagens verdes indicam sucesso, vermelhas indicam erro.</p>
        </div>
      </div>

      <div class="faq-item">
        <button class="faq-question" onclick="toggleFaq(this)">
          O sistema funciona se faltar energia el√©trica?
          <span class="faq-icon">‚ñº</span>
        </button>
        <div class="faq-answer">
          <p>Se faltar energia, as lumin√°rias obviamente apagam. Quando a energia retorna, o sistema reinicia automaticamente e volta a funcionar com as √∫ltimas configura√ß√µes salvas.</p>
        </div>
      </div>

      <div class="faq-item">
        <button class="faq-question" onclick="toggleFaq(this)">
          Posso criar agendamentos diferentes para cada dia da semana?
          <span class="faq-icon">‚ñº</span>
        </button>
        <div class="faq-answer">
          <p>Atualmente o sistema funciona com agendamentos di√°rios (mesmo hor√°rio todos os dias). Para hor√°rios espec√≠ficos de cada dia, voc√™ precisar√° ajustar manualmente conforme necess√°rio.</p>
        </div>
      </div>

      <div class="faq-item">
        <button class="faq-question" onclick="toggleFaq(this)">
          O que s√£o "dados reais" e como diferem de estimativas?
          <span class="faq-icon">‚ñº</span>
        </button>
        <div class="faq-answer">
          <p>Dados reais s√£o medi√ß√µes diretas coletadas pelo ESP32 a cada hora. Diferente de estimativas ou simula√ß√µes, estes representam o consumo efetivo registrado pelo hardware. Voc√™ ver√° apenas hor√°rios onde h√° registros v√°lidos do sistema.</p>
        </div>
      </div>

      <div class="faq-item">
        <button class="faq-question" onclick="toggleFaq(this)">
          Por que alguns registros aparecem como "Recuperado"?
          <span class="faq-icon">‚ñº</span>
        </button>
        <div class="faq-answer">
          <p>Quando h√° falhas tempor√°rias (falta de energia, problemas de rede), o sistema detecta lacunas nos dados e as preenche automaticamente com base nos valores atuais. Estes aparecem marcados como "üîÑ Recuperado" para transpar√™ncia total.</p>
        </div>
      </div>

      <div class="faq-item">
        <button class="faq-question" onclick="toggleFaq(this)">
          Com que frequ√™ncia os dados de consumo s√£o coletados?
          <span class="faq-icon">‚ñº</span>
        </button>
        <div class="faq-answer">
          <p>O ESP32 coleta dados automaticamente a cada hora cheia (ex: 14:00, 15:00, 16:00). A tela √© atualizada automaticamente a cada minuto, mas novos registros s√≥ aparecem ap√≥s cada coleta hor√°ria do hardware.</p>
        </div>
      </div>

      <div class="faq-item">
        <button class="faq-question" onclick="toggleFaq(this)">
          Posso recuperar dados ap√≥s usar "Resetar Hist√≥rico"?
          <span class="faq-icon">‚ñº</span>
        </button>
        <div class="faq-answer">
          <p>N√£o! O reset √© permanente e irrevers√≠vel. Todos os dados hist√≥ricos s√£o apagados definitivamente. Use esta fun√ß√£o apenas quando realmente necess√°rio reiniciar a coleta do zero. Recomendamos fazer backup via "Exportar Excel" antes.</p>
        </div>
      </div>

      <div class="faq-item">
        <button class="faq-question" onclick="toggleFaq(this)">
          O que significa "efici√™ncia energ√©tica" na tela de consumo?
          <span class="faq-icon">‚ñº</span>
        </button>
        <div class="faq-answer">
          <p>√â uma m√©trica que indica qu√£o bem o sistema est√° sendo utilizado. Valores altos (acima de 80%) indicam uso eficiente. Valores baixos podem indicar desperd√≠cio ou problemas t√©cnicos.</p>
        </div>
      </div>

      <div class="faq-item">
        <button class="faq-question" onclick="toggleFaq(this)">
          Por que o sistema usa dois ESP32 ao inv√©s de um?
          <span class="faq-icon">‚ñº</span>
        </button>
        <div class="faq-answer">
          <p>A arquitetura distribu√≠da oferece maior confiabilidade, melhor performance e facilita manuten√ß√£o. O ESP32 Mestre cuida da interface web e agendamentos, enquanto o Escravo controla as lumin√°rias e sensores. Se um falhar, o outro continua funcionando.</p>
        </div>
      </div>

      <div class="faq-item">
        <button class="faq-question" onclick="toggleFaq(this)">
          Como o sensor LDR funciona para detectar luz ambiente?
          <span class="faq-icon">‚ñº</span>
        </button>
        <div class="faq-answer">
          <p>O LDR √© um fotoresistor que muda sua resist√™ncia conforme a luz. Durante o dia (muita luz), sua resist√™ncia √© baixa (~1kŒ©). √Ä noite (pouca luz), aumenta (~10kŒ©). Junto com o resistor de 220Œ©, forma um divisor de tens√£o que o ESP32 l√™ no GPIO35.</p>
        </div>
      </div>
    </section>

    <!-- Se√ß√£o 12: Contato -->
    <section class="manual-section" id="contato">
      <h2 class="section-title">
        <span class="section-icon">üìû</span>
        Suporte T√©cnico
      </h2>
      
      <div class="subsection">
        <h3 class="subsection-title">üÜò Quando Contatar o Suporte</h3>
        <ul>
          <li>Sistema completamente fora do ar</li>
          <li>Lumin√°rias em "Sem Comunica√ß√£o" por mais de 30 minutos</li>
          <li>Problemas na comunica√ß√£o entre ESP32 Mestre e Escravo</li>
          <li>Sensor LDR n√£o funciona corretamente</li>
          <li>D√∫vidas sobre configura√ß√µes avan√ßadas</li>
          <li>Solicita√ß√£o de novos recursos ou melhorias</li>
        </ul>
      </div>

      <div class="subsection">
        <h3 class="subsection-title">üìã Informa√ß√µes para Fornecer ao Suporte</h3>
        <ol class="step-list">
          <li class="step-item">
            <div class="step-title">Descreva o Problema</div>
            <div class="step-description">Explique detalhadamente o que est√° acontecendo e quando come√ßou.</div>
          </li>
          <li class="step-item">
            <div class="step-title">Informe os Setores Afetados</div>
            <div class="step-description">Diga se √© no estacionamento, loja, dep√≥sito ou em todos.</div>
          </li>
          <li class="step-item">
            <div class="step-title">Especifique o ESP32</div>
            <div class="step-description">Informe se o problema √© no ESP32 Mestre (interface web) ou Escravo (lumin√°rias/sensores).</div>
          </li>
          <li class="step-item">
            <div class="step-title">Tire Screenshots</div>
            <div class="step-description">Se poss√≠vel, tire fotos da tela mostrando o problema.</div>
          </li>
          <li class="step-item">
            <div class="step-title">Teste B√°sico</div>
            <div class="step-description">Tente recarregar a p√°gina (F5) e informe se o problema persiste.</div>
          </li>
        </ol>
      </div>

      <div class="highlight-box info">
        <div class="highlight-box-title">
          <span class="highlight-box-icon">üìû</span>
          Contatos de Suporte
        </div>       
        <p><strong>Engemase Engenharia</strong><br>
        üåê Website: www.engemase.com.br<br>
        üìß Email: suporte@engemase.com.br<br>
        üìû Telefone: +55 (49) 3567-2016</p>
      </div>

      <div class="highlight-box tip">
        <div class="highlight-box-title">
          <span class="highlight-box-icon">‚è∞</span>
          Hor√°rio de Atendimento
        </div>
        <p><strong>Suporte T√©cnico:</strong><br>
        Segunda a Sexta: 7h30 √†s 17h48<br>
        <strong>Emerg√™ncias:</strong> 24 horas por dia<br>
        (Apenas para problemas cr√≠ticos de seguran√ßa)</p>
      </div>
    </section>

    <!-- Conclus√£o -->
    <section class="manual-section">
      <h2 class="section-title">
        <span class="section-icon">üéØ</span>
        Conclus√£o
      </h2>
      
      <div class="highlight-box tip">
        <div class="highlight-box-title">
          <span class="highlight-box-icon">üéì</span>
          Parab√©ns! Voc√™ Est√° Pronto
        </div>
        <p>Agora voc√™ tem todo o conhecimento necess√°rio para operar o Sistema de Ilumina√ß√£o Viza com seguran√ßa e efici√™ncia. Lembre-se:</p>
        <ul>
          <li>‚úÖ Sempre verifique o status de conex√£o antes de fazer altera√ß√µes</li>
          <li>‚úÖ Use agendamentos para automatizar a opera√ß√£o</li>
          <li>‚úÖ Monitore o consumo regularmente para otimizar custos</li>
          <li>‚úÖ Compreenda a arquitetura dual ESP32 para melhor troubleshooting</li>
          <li>‚úÖ Mantenha este manual sempre √† disposi√ß√£o</li>
          <li>‚úÖ N√£o hesite em contatar o suporte quando necess√°rio</li>
        </ul>
      </div>

      <div class="demo-container">
        <div class="demo-title">üöÄ Teste Seus Conhecimentos</div>
        <p style="margin-bottom: 20px;">Agora que voc√™ leu o manual, que tal testar o sistema? Sugerimos come√ßar com estas a√ß√µes seguras:</p>
        <div style="text-align: left; max-width: 600px; margin: 0 auto;">
          <p><strong>1. üëÄ Visualiza√ß√£o:</strong> V√° na tela de Visualiza√ß√£o e observe o status atual das lumin√°rias</p>
          <p><strong>2. ‚è∞ Hor√°rio:</strong> Na tela de Controle, sincronize o rel√≥gio do sistema</p>
          <p><strong>3. üìä Consumo:</strong> Configure a tarifa de energia na tela de Consumo</p>
          <p><strong>4. üß™ Teste Manual:</strong> Mude um setor para Modo Manual, ajuste o brilho e volte para Autom√°tico</p>
          <p><strong>5. üîå Verifique Conex√µes:</strong> Consulte os esquemas de liga√ß√£o para entender melhor o sistema</p>
        </div>
      </div>
    </section>
  </div>

  <!-- Menu Inferior Estilo App -->
  <nav class="bottom-nav">
    <div class="nav-container">
      <a href="/" class="nav-item">
        <div class="nav-icon">üè¢</div>
        <div class="nav-label">Opera√ß√£o</div>
      </a>
      <a href="/Visualizacao" class="nav-item">
        <div class="nav-icon">üìä</div>
        <div class="nav-label">Visualiza√ß√£o</div>
      </a>
      <a href="/Consumo" class="nav-item">
        <div class="nav-icon">‚ö°</div>
        <div class="nav-label">Consumo</div>
      </a>
      <a href="/Banco" class="nav-item">
        <div class="nav-icon">üóÑÔ∏è</div>
        <div class="nav-label">Banco</div>
      </a>
      <a href="/Manual" class="nav-item active">
        <div class="nav-icon">üìñ</div>
        <div class="nav-label">Manual</div>
      </a>
    </div>
  </nav>

  <!-- Bot√£o de download PDF -->
  <button class="download-pdf-btn" id="downloadPdfBtn" onclick="gerarPDF()">
    <span class="download-pdf-icon">üìÑ</span>
    <span class="download-pdf-text">Download PDF</span>
  </button>

  <!-- Modal de progresso do PDF -->
  <div class="pdf-progress-modal" id="pdfProgressModal">
    <div class="pdf-progress-content">
      <div class="pdf-progress-title">üìÑ Gerando Manual em PDF</div>
      <div class="pdf-progress-bar-container">
        <div class="pdf-progress-bar" id="pdfProgressBar"></div>
      </div>
      <div class="pdf-progress-text" id="pdfProgressText">Preparando documento...</div>
    </div>
  </div>

  <script>
    // ========== SISTEMA DE NOTIFICA√á√ïES TOAST ==========
    
    // Classe Das Notifica√ß√µes
    class ToastManager {
      constructor() {
        this.container = document.getElementById('toast-container');
        this.toasts = new Map();
        this.nextId = 1;
      }

      isDuplicate(title, message) {
        for (let [id, toastData] of this.toasts) {
          const existingTitle = toastData.element.querySelector('.toast-title')?.textContent;
          const existingMessage = toastData.element.querySelector('.toast-message')?.textContent || '';
          
          if (existingTitle === title && existingMessage === message) {
            return id;
          }
        }
        return null;
      }

      show(type = 'info', title, message, options = {}) {
        // ANTI-DUPLICATA: Verificar se j√° existe toast similar
        const duplicateId = this.isDuplicate(title, message);
        if (duplicateId) {
          // Se encontrou duplicata, apenas resetar o timer do existente
          const existingToast = this.toasts.get(duplicateId);
          if (existingToast && !existingToast.config.persistent) {
            this.scheduleRemoval(duplicateId, options.duration || existingToast.config.duration);
          }
          return duplicateId;
        }

        // LIMITE M√ÅXIMO: Remover toasts antigos se exceder limite
        if (this.toasts.size >= 3) {
          const oldestId = this.toasts.keys().next().value;
          this.remove(oldestId);
        }
        
        const id = this.nextId++;
        
        const config = {
          duration: options.duration || (type === 'error' ? 6000 : 4000),
          persistent: options.persistent || false,
          closable: options.closable !== false,
          action: options.action || null,
          ...options
        };

        const toast = this.createToast(id, type, title, message, config);
        this.container.appendChild(toast);
        this.toasts.set(id, { element: toast, config });

        // Mostrar com anima√ß√£o
        requestAnimationFrame(() => {
          toast.classList.add('show');
        });

        // Auto-dismiss se n√£o for persistente
        if (!config.persistent) {
          this.scheduleRemoval(id, config.duration);
        }

        return id;
      }

      createToast(id, type, title, message, config) {
        const toast = document.createElement('div');
        toast.className = `toast ${type}`;
        toast.setAttribute('role', 'alert');
        toast.setAttribute('aria-live', 'polite');

        const icons = {
          success: '‚úÖ',
          error: '‚ùå', 
          warning: '‚ö†Ô∏è',
          info: '‚ÑπÔ∏è',
          system: '‚öôÔ∏è'
        };

        toast.innerHTML = `
          <div class="toast-icon">${icons[type] || '‚ÑπÔ∏è'}</div>
          <div class="toast-content">
            <div class="toast-title">${title}</div>
            ${message ? `<div class="toast-message">${message}</div>` : ''}
          </div>
          ${config.closable ? '<button class="toast-close" aria-label="Fechar">√ó</button>' : ''}
          ${!config.persistent ? '<div class="toast-progress"></div>' : ''}
        `;

        if (config.closable) {
          const closeBtn = toast.querySelector('.toast-close');
          closeBtn.addEventListener('click', () => this.remove(id));
        }

        if (config.action) {
          const actionBtn = document.createElement('button');
          actionBtn.textContent = config.action.text;
          actionBtn.className = 'toast-action';
          actionBtn.addEventListener('click', config.action.callback);
          toast.querySelector('.toast-content').appendChild(actionBtn);
        }

        if (!config.persistent) {
          const progress = toast.querySelector('.toast-progress');
          if (progress) {
            progress.style.width = '100%';
            progress.style.transition = `width ${config.duration}ms linear`;
            requestAnimationFrame(() => {
              progress.style.width = '0%';
            });
          }
        }

        return toast;
      }

      scheduleRemoval(id, delay) {
        setTimeout(() => {
          this.remove(id);
        }, delay);
      }

      remove(id) {
        const toastData = this.toasts.get(id);
        if (!toastData) return;

        const { element } = toastData;
        element.classList.add('hide');

        setTimeout(() => {
          if (element.parentNode) {
            element.parentNode.removeChild(element);
          }
          this.toasts.delete(id);
        }, 400);
      }

      success(title, message, options) {
        return this.show('success', title, message, options);
      }

      error(title, message, options) {
        return this.show('error', title, message, { persistent: true, ...options });
      }

      warning(title, message, options) {
        return this.show('warning', title, message, options);
      }

      info(title, message, options) {
        return this.show('info', title, message, options);
      }

      system(title, message, options) {
        return this.show('system', title, message, options);
      }
    }

    // Inst√¢ncia global do toast
    const toast = new ToastManager();

    // ========== CONTROLE DE TABS DOS ESQUEMAS ==========
    
    function showTab(tabName) {
      // Esconder todas as tabs
      document.querySelectorAll('.tab-content').forEach(tab => {
        tab.classList.remove('active');
      });
      
      // Remover classe active de todos os bot√µes
      document.querySelectorAll('.tab-button').forEach(button => {
        button.classList.remove('active');
      });
      
      // Mostrar tab selecionada
      document.getElementById('tab-' + tabName).classList.add('active');
      
      // Ativar bot√£o correspondente
      event.target.classList.add('active');
    }

    // ========== FUN√á√ïES DE BUSCA NO MANUAL ==========
    
    // Vari√°veis globais para navega√ß√£o de busca
    let resultadosBusca = [];
    let indiceAtual = 0;
    
    function limparPesquisa() {
      const searchInput = document.getElementById('searchInput');
      const searchResultsInfo = document.getElementById('searchResultsInfo');
      const searchClear = document.getElementById('searchClear');
      const searchNavigation = document.getElementById('searchNavigation');
      
      if (searchInput) searchInput.value = '';
      if (searchResultsInfo) searchResultsInfo.classList.remove('visible');
      if (searchClear) searchClear.classList.remove('visible');
      if (searchNavigation) searchNavigation.style.display = 'none';
      
      // Resetar vari√°veis de navega√ß√£o
      resultadosBusca = [];
      indiceAtual = 0;
      
      // Remover todos os destaques
      document.querySelectorAll('.search-highlight').forEach(el => {
        const parent = el.parentNode;
        if (parent) {
          parent.replaceChild(document.createTextNode(el.textContent), el);
          parent.normalize();
        }
      });
    }

    function realizarBusca(termo) {
      limparPesquisa();
      
      if (!termo || termo.length < 2) {
        toast.warning('Busca Inv√°lida', 'Digite pelo menos 2 caracteres');
        return;
      }
      
      const searchClear = document.getElementById('searchClear');
      const searchResultsInfo = document.getElementById('searchResultsInfo');
      const searchResultsText = document.getElementById('searchResultsText');
      const searchNavigation = document.getElementById('searchNavigation');
      
      if (searchClear) searchClear.classList.add('visible');
      
      const regex = new RegExp(`(${termo.replace(/[.*+?^${}()|[\]\\]/g, '\\$&')})`, 'gi');
      resultadosBusca = []; // Limpar array de resultados
      
      // Buscar em todas as se√ß√µes
      const sections = document.querySelectorAll('.manual-section, .subsection, .highlight-box, .step-item, .faq-item');
      
      sections.forEach(section => {
        const walker = document.createTreeWalker(
          section,
          NodeFilter.SHOW_TEXT,
          {
            acceptNode: function(node) {
              if (node.parentElement.tagName === 'SCRIPT' || 
                  node.parentElement.tagName === 'STYLE' ||
                  node.parentElement.classList.contains('search-container')) {
                return NodeFilter.FILTER_REJECT;
              }
              return NodeFilter.FILTER_ACCEPT;
            }
          }
        );
        
        const nodesToReplace = [];
        let node;
        while (node = walker.nextNode()) {
          if (regex.test(node.textContent)) {
            nodesToReplace.push(node);
          }
        }
        
        nodesToReplace.forEach(node => {
          const span = document.createElement('span');
          span.innerHTML = node.textContent.replace(regex, '<span class="search-highlight">$1</span>');
          node.parentElement.replaceChild(span, node);
          
          // Adicionar todos os highlights ao array de resultados
          const highlights = span.querySelectorAll('.search-highlight');
          highlights.forEach(highlight => {
            resultadosBusca.push(highlight);
          });
        });
      });
      
      // Mostrar resultados
      if (searchResultsInfo && searchResultsText) {
        if (resultadosBusca.length > 0) {
          searchResultsText.innerHTML = `‚úÖ Encontrados <strong>${resultadosBusca.length}</strong> resultado(s) para "<strong>${termo}</strong>"`;
          searchResultsInfo.classList.add('visible');
          
          // Mostrar navega√ß√£o se houver mais de 1 resultado
          if (resultadosBusca.length > 1 && searchNavigation) {
            searchNavigation.style.display = 'flex';
          }
          
          // Ir para o primeiro resultado
          indiceAtual = 0;
          atualizarResultadoAtivo();
          
          toast.success('Busca Conclu√≠da', `${resultadosBusca.length} resultado(s) encontrado(s)`, {
            duration: 3000
          });
        } else {
          searchResultsText.innerHTML = `‚ùå Nenhum resultado encontrado para "<strong>${termo}</strong>"`;
          searchResultsInfo.classList.add('visible');
          toast.warning('Sem Resultados', 'Tente usar termos diferentes');
        }
      }
    }
    
    function atualizarResultadoAtivo() {
      if (resultadosBusca.length === 0) return;
      
      // Remover classe active de todos
      resultadosBusca.forEach(el => el.classList.remove('active'));
      
      // Adicionar classe active ao atual
      const elementoAtivo = resultadosBusca[indiceAtual];
      if (elementoAtivo) {
        elementoAtivo.classList.add('active');
        
        // Scroll suave para o elemento
        elementoAtivo.scrollIntoView({ 
          behavior: 'smooth', 
          block: 'center',
          inline: 'nearest'
        });
        
        // Atualizar contador
        const searchCounter = document.getElementById('searchCounter');
        if (searchCounter) {
          searchCounter.textContent = `${indiceAtual + 1}/${resultadosBusca.length}`;
        }
        
        // Atualizar estado dos bot√µes
        const prevBtn = document.getElementById('searchPrevBtn');
        const nextBtn = document.getElementById('searchNextBtn');
        
        if (prevBtn) {
          prevBtn.disabled = (indiceAtual === 0);
        }
        if (nextBtn) {
          nextBtn.disabled = (indiceAtual === resultadosBusca.length - 1);
        }
      }
    }
    
    function navegarProximoResultado() {
      if (indiceAtual < resultadosBusca.length - 1) {
        indiceAtual++;
        atualizarResultadoAtivo();
      }
    }
    
    function navegarResultadoAnterior() {
      if (indiceAtual > 0) {
        indiceAtual--;
        atualizarResultadoAtivo();
      }
    }

    // Fun√ß√£o para voltar ao topo
    function voltarAoTopo() {
      window.scrollTo({
        top: 0,
        behavior: 'smooth'
      });
    }

    // ========== GERA√á√ÉO DE PDF ==========

    async function gerarPDF() {
      const btn = document.getElementById('downloadPdfBtn');
      const modal = document.getElementById('pdfProgressModal');
      const progressBar = document.getElementById('pdfProgressBar');
      const progressText = document.getElementById('pdfProgressText');
      
      // Verificar se as bibliotecas est√£o carregadas
      if (typeof window.jsPDF === 'undefined' || typeof html2canvas === 'undefined') {
        toast.error('Erro no Download', 'Bibliotecas PDF n√£o carregadas. Tente recarregar a p√°gina.');
        return;
      }
      
      // Preparar interface
      btn.disabled = true;
      btn.innerHTML = '<span class="pdf-loading"></span><span class="download-pdf-text">Gerando...</span>';
      modal.style.display = 'flex';
      
      try {
        // Atualizar progresso
        atualizarProgressoPDF(10, 'Preparando conte√∫do...');
        
        // Criar uma vers√£o limpa do conte√∫do para PDF
        const conteudoOriginal = document.querySelector('.container');
        const conteudoPDF = conteudoOriginal.cloneNode(true);
        
        // Remover elementos que n√£o devem aparecer no PDF
        const elementosRemover = [
          '.demo-container',
          '.toast-container',
          '.pdf-progress-modal'
        ];
        
        elementosRemover.forEach(seletor => {
          conteudoPDF.querySelectorAll(seletor).forEach(el => el.remove());
        });
        
        // Expandir todas as FAQs no clone
        conteudoPDF.querySelectorAll('.faq-question').forEach(q => {
          q.classList.add('active');
          const answer = q.nextElementSibling;
          if (answer) {
            answer.classList.add('active');
            answer.style.display = 'block';
            answer.style.maxHeight = 'none';
            answer.style.padding = '15px 20px';
          }
        });
        
        // Expandir todas as tabs no clone
        conteudoPDF.querySelectorAll('.tab-content').forEach(tab => {
          tab.classList.add('active');
          tab.style.display = 'block';
        });
        
        // Criar wrapper para o conte√∫do
        const wrapperPDF = document.createElement('div');
        wrapperPDF.style.background = 'white';
        wrapperPDF.style.fontFamily = 'Arial, sans-serif';
        wrapperPDF.style.fontSize = '11px';
        wrapperPDF.style.lineHeight = '1.4';
        wrapperPDF.style.color = '#333';
        wrapperPDF.style.padding = '0';
        wrapperPDF.style.margin = '0';
        
        // Ajustar estilos do conte√∫do para PDF (vers√£o compacta)
        conteudoPDF.style.padding = '8mm';
        conteudoPDF.style.maxWidth = 'none';
        conteudoPDF.style.marginLeft = '0';
        
        // Ajustar t√≠tulo principal
        const mainTitle = conteudoPDF.querySelector('.main-title');
        if (mainTitle) {
          mainTitle.style.marginBottom = '8px';
          mainTitle.style.textAlign = 'center';
          const h1 = mainTitle.querySelector('h1');
          if (h1) {
            h1.style.fontSize = '18px';
            h1.style.marginBottom = '4px';
            h1.style.color = '#2c3e50';
          }
          const p = mainTitle.querySelector('p');
          if (p) {
            p.style.fontSize = '10px';
            p.style.margin = '0';
          }
        }
        
        // Ajustar se√ß√µes de forma muito compacta
        conteudoPDF.querySelectorAll('.manual-section').forEach(secao => {
          secao.style.background = 'white';
          secao.style.boxShadow = 'none';
          secao.style.border = '1px solid #ddd';
          secao.style.borderRadius = '4px';
          secao.style.marginBottom = '6px';
          secao.style.padding = '8px';
          secao.style.pageBreakInside = 'avoid';
        });
        
        // Ajustar t√≠tulos das se√ß√µes
        conteudoPDF.querySelectorAll('.section-title').forEach(titulo => {
          titulo.style.fontSize = '12px';
          titulo.style.color = '#2c3e50';
          titulo.style.marginBottom = '6px';
          titulo.style.marginTop = '0';
          titulo.style.lineHeight = '1.2';
          titulo.style.fontWeight = '700';
          
          // Ajustar √≠cones
          const icon = titulo.querySelector('.section-icon');
          if (icon) {
            icon.style.fontSize = '10px';
            icon.style.padding = '3px';
            icon.style.marginRight = '4px';
          }
        });
        
        // Ajustar subsse√ß√µes
        conteudoPDF.querySelectorAll('.subsection').forEach(sub => {
          sub.style.margin = '4px 0';
          sub.style.padding = '6px';
          sub.style.background = '#f8f9fa';
          sub.style.borderRadius = '3px';
          sub.style.borderLeft = '2px solid #c33636';
        });
        
        conteudoPDF.querySelectorAll('.subsection-title').forEach(subTitulo => {
          subTitulo.style.fontSize = '10px';
          subTitulo.style.marginBottom = '4px';
          subTitulo.style.marginTop = '0';
          subTitulo.style.fontWeight = '600';
        });
        
        // Ajustar par√°grafos
        conteudoPDF.querySelectorAll('p').forEach(p => {
          p.style.fontSize = '9px';
          p.style.lineHeight = '1.3';
          p.style.marginBottom = '4px';
          p.style.marginTop = '0';
        });
        
        // Ajustar listas
        conteudoPDF.querySelectorAll('ul, ol').forEach(lista => {
          lista.style.marginBottom = '4px';
          lista.style.marginTop = '0';
          lista.style.paddingLeft = '12px';
        });
        
        conteudoPDF.querySelectorAll('li').forEach(item => {
          item.style.fontSize = '9px';
          item.style.lineHeight = '1.2';
          item.style.marginBottom = '2px';
        });
        
        // Ajustar caixas de destaque
        conteudoPDF.querySelectorAll('.highlight-box').forEach(box => {
          box.style.padding = '6px';
          box.style.margin = '4px 0';
          box.style.borderRadius = '3px';
          box.style.pageBreakInside = 'avoid';
        });
        
        conteudoPDF.querySelectorAll('.highlight-box-title').forEach(boxTitle => {
          boxTitle.style.fontSize = '9px';
          boxTitle.style.marginBottom = '3px';
          boxTitle.style.fontWeight = '600';
        });
        
        // Ajustar passos numerados
        conteudoPDF.querySelectorAll('.step-list').forEach(stepList => {
          stepList.style.margin = '4px 0';
        });
        
        conteudoPDF.querySelectorAll('.step-item').forEach(step => {
          step.style.marginBottom = '4px';
          step.style.padding = '6px 6px 6px 16px';
          step.style.background = 'white';
          step.style.border = '1px solid #eee';
          step.style.borderRadius = '3px';
          step.style.borderLeft = '3px solid #28a745';
          step.style.position = 'relative';
          step.style.fontSize = '9px';
          step.style.lineHeight = '1.2';
          step.style.pageBreakInside = 'avoid';
        });
        
        conteudoPDF.querySelectorAll('.step-title').forEach(stepTitle => {
          stepTitle.style.fontSize = '9px';
          stepTitle.style.fontWeight = '600';
          stepTitle.style.marginBottom = '2px';
        });
        
        conteudoPDF.querySelectorAll('.step-description').forEach(stepDesc => {
          stepDesc.style.fontSize = '8px';
          stepDesc.style.lineHeight = '1.2';
        });
        
        // Ajustar FAQs
        conteudoPDF.querySelectorAll('.faq-item').forEach(faq => {
          faq.style.marginBottom = '4px';
          faq.style.background = 'white';
          faq.style.border = '1px solid #ddd';
          faq.style.borderRadius = '3px';
          faq.style.pageBreakInside = 'avoid';
        });
        
        conteudoPDF.querySelectorAll('.faq-question').forEach(question => {
          question.style.padding = '6px';
          question.style.fontSize = '9px';
          question.style.fontWeight = '600';
          question.style.background = '#f5f5f5';
          question.style.margin = '0';
          question.style.lineHeight = '1.2';
        });
        
        conteudoPDF.querySelectorAll('.faq-answer').forEach(answer => {
          answer.style.padding = '6px';
          answer.style.fontSize = '8px';
          answer.style.lineHeight = '1.2';
          answer.style.background = 'white';
          answer.style.display = 'block';
          answer.style.maxHeight = 'none';
        });
        
        // Ajustar troubleshooting
        conteudoPDF.querySelectorAll('.troubleshoot-item').forEach(trouble => {
          trouble.style.display = 'block';
          trouble.style.padding = '6px';
          trouble.style.marginBottom = '4px';
          trouble.style.background = 'white';
          trouble.style.border = '1px solid #ddd';
          trouble.style.borderRadius = '3px';
          trouble.style.borderLeft = '3px solid #ef4444';
          trouble.style.pageBreakInside = 'avoid';
        });
        
        conteudoPDF.querySelectorAll('.troubleshoot-content h4').forEach(h4 => {
          h4.style.fontSize = '9px';
          h4.style.fontWeight = '600';
          h4.style.marginBottom = '2px';
          h4.style.marginTop = '0';
        });
        
        conteudoPDF.querySelectorAll('.troubleshoot-content p').forEach(p => {
          p.style.fontSize = '8px';
          p.style.lineHeight = '1.2';
          p.style.margin = '0';
        });
        
        // Remover √≠cones de troubleshooting para economizar espa√ßo
        conteudoPDF.querySelectorAll('.troubleshoot-icon').forEach(icon => {
          icon.style.display = 'none';
        });
        
        // Ajustar componentes grid
        conteudoPDF.querySelectorAll('.componentes-grid').forEach(grid => {
          grid.style.display = 'block';
          grid.style.margin = '4px 0';
        });
        
        conteudoPDF.querySelectorAll('.componente-item').forEach(item => {
          item.style.display = 'block';
          item.style.marginBottom = '4px';
          item.style.padding = '6px';
          item.style.background = 'white';
          item.style.border = '1px solid #ddd';
          item.style.borderRadius = '3px';
          item.style.pageBreakInside = 'avoid';
        });
        
        conteudoPDF.querySelectorAll('.componente-info h4').forEach(h4 => {
          h4.style.fontSize = '9px';
          h4.style.fontWeight = '600';
          h4.style.marginBottom = '2px';
          h4.style.marginTop = '0';
        });
        
        conteudoPDF.querySelectorAll('.componente-info p').forEach(p => {
          p.style.fontSize = '8px';
          p.style.lineHeight = '1.2';
          p.style.margin = '0';
        });
        
        // Ajustar tabelas
        conteudoPDF.querySelectorAll('.especificacoes-tabela').forEach(tabela => {
          tabela.style.margin = '4px 0';
          tabela.style.fontSize = '8px';
        });
        
        conteudoPDF.querySelectorAll('.especificacoes-tabela th, .especificacoes-tabela td').forEach(cell => {
          cell.style.padding = '4px 6px';
          cell.style.fontSize = '8px';
          cell.style.lineHeight = '1.2';
        });
        
        // Ajustar diagramas de pinagem
        conteudoPDF.querySelectorAll('.pin-diagram').forEach(diagram => {
          diagram.style.margin = '4px 0';
          diagram.style.padding = '6px';
          diagram.style.fontSize = '8px';
          diagram.style.pageBreakInside = 'avoid';
        });
        
        conteudoPDF.querySelectorAll('.pin-esp32').forEach(esp => {
          esp.style.padding = '6px';
          esp.style.fontSize = '9px';
          esp.style.margin = '4px 0';
        });
        
        conteudoPDF.querySelectorAll('.pin-connection').forEach(conn => {
          conn.style.padding = '3px 0';
          conn.style.fontSize = '8px';
        });
        
        // Ajustar espa√ßamentos gerais
        conteudoPDF.querySelectorAll('h1, h2, h3, h4, h5, h6').forEach(heading => {
          heading.style.marginTop = '0';
          heading.style.marginBottom = '4px';
        });
        
        // Compactar espa√ßos em branco desnecess√°rios
        conteudoPDF.querySelectorAll('*').forEach(el => {
          if (el.style.marginTop && parseInt(el.style.marginTop) > 8) {
            el.style.marginTop = '6px';
          }
          if (el.style.marginBottom && parseInt(el.style.marginBottom) > 8) {
            el.style.marginBottom = '4px';
          }
        });
        
        wrapperPDF.appendChild(conteudoPDF);
        
        // Criar elemento tempor√°rio para renderiza√ß√£o
        const tempContainer = document.createElement('div');
        tempContainer.style.position = 'absolute';
        tempContainer.style.left = '-9999px';
        tempContainer.style.top = '0';
        tempContainer.style.width = '210mm'; // Largura A4
        tempContainer.appendChild(wrapperPDF);
        document.body.appendChild(tempContainer);
        
        atualizarProgressoPDF(30, 'Renderizando conte√∫do...');
        
        // Aguardar um pouco para renderiza√ß√£o
        await new Promise(resolve => setTimeout(resolve, 500));
        
        // Configurar html2canvas
        const canvas = await html2canvas(tempContainer, {
          scale: 1.5,
          useCORS: true,
          allowTaint: true,
          backgroundColor: '#ffffff',
          width: tempContainer.scrollWidth,
          height: tempContainer.scrollHeight,
          onprogress: function(progress) {
            const progressPercent = 30 + (progress * 40);
            atualizarProgressoPDF(progressPercent, 'Capturando p√°ginas...');
          }
        });
        
        atualizarProgressoPDF(75, 'Criando documento PDF...');
        
        // Configurar jsPDF
        const { jsPDF } = window.jsPDF;
        const pdf = new jsPDF({
          orientation: 'portrait',
          unit: 'mm',
          format: 'a4'
        });
        
        // Dimens√µes da p√°gina A4 em mm (vers√£o compacta)
        const pageWidth = 210;
        const pageHeight = 297;
        const margin = 8; // Margens reduzidas
        const contentWidth = pageWidth - (margin * 2);
        const contentHeight = pageHeight - (margin * 2) - 8; // Espa√ßo reduzido para numera√ß√£o
        
        // Calcular dimens√µes da imagem
        const imgWidth = contentWidth;
        const imgHeight = (canvas.height * contentWidth) / canvas.width;
        
        // Dividir em m√∫ltiplas p√°ginas
        const numPages = Math.ceil(imgHeight / contentHeight);
        
        for (let i = 0; i < numPages; i++) {
          if (i > 0) pdf.addPage();
          
          // Calcular posi√ß√£o Y para esta p√°gina
          const yOffset = -(i * contentHeight);
          pdf.addImage(canvas.toDataURL('image/jpeg', 0.85), 'JPEG', margin, margin + yOffset, imgWidth, imgHeight);
          
          // Adicionar numera√ß√£o de p√°gina no rodap√©
          pdf.setFontSize(9);
          pdf.setTextColor(100, 100, 100);
          const pageText = `${i + 1} / ${numPages}`;
          const textWidth = pdf.getTextWidth(pageText);
          pdf.text(pageText, (pageWidth - textWidth) / 2, pageHeight - 5);
          
          // Atualizar progresso
          const pageProgress = 75 + ((i + 1) / numPages) * 20;
          atualizarProgressoPDF(pageProgress, `Criando p√°gina ${i + 1} de ${numPages}...`);
          
          // Pequena pausa para n√£o travar a interface
          await new Promise(resolve => setTimeout(resolve, 100));
        }
        
        atualizarProgressoPDF(95, 'Finalizando download...');
        
        // Gerar nome do arquivo com data
        const agora = new Date();
        const dataFormatada = agora.toISOString().split('T')[0];
        const nomeArquivo = `Manual_Sistema_Viza_${dataFormatada}.pdf`;
        
        // Fazer download
        pdf.save(nomeArquivo);
        
        atualizarProgressoPDF(100, 'Download conclu√≠do!');
        
        // Limpar elemento tempor√°rio
        document.body.removeChild(tempContainer);
        
        // Sucesso
        setTimeout(() => {
          modal.style.display = 'none';
          toast.success('PDF Gerado com Sucesso!', `Manual salvo como: ${nomeArquivo}`, {
            duration: 8000
          });
        }, 1000);
        
      } catch (error) {
        console.error('Erro ao gerar PDF:', error);
        modal.style.display = 'none';
        toast.error('Erro ao Gerar PDF', 'Falha na gera√ß√£o do documento. Tente novamente ou use a impress√£o do navegador (Ctrl+P).', {
          action: {
            text: 'Imprimir',
            callback: () => window.print()
          }
        });
      } finally {
        // Restaurar bot√£o
        btn.disabled = false;
        btn.innerHTML = '<span class="download-pdf-icon">üìÑ</span><span class="download-pdf-text">Download PDF</span>';
      }
    }

    // Fun√ß√£o Para Atualizar Progresso De Download Do PDF
    function atualizarProgressoPDF(porcentagem, texto) {
      const progressBar = document.getElementById('pdfProgressBar');
      const progressText = document.getElementById('pdfProgressText');
      
      if (progressBar) {
        progressBar.style.width = porcentagem + '%';
      }
      
      if (progressText) {
        progressText.textContent = texto;
      }
    }

    // Fun√ß√£o alternativa usando a impress√£o do navegador
    function gerarPDFSimples() {
      // Ocultar elementos que n√£o devem aparecer no PDF
      const elementosOcultar = [
        '.floating-index',
        '.download-pdf-btn',
        '.toast-container',
        '.demo-container',
        'header nav'
      ];
      
      // Guardar estados originais
      const estadosOriginais = [];
      
      elementosOcultar.forEach(seletor => {
        document.querySelectorAll(seletor).forEach(el => {
          estadosOriginais.push({
            elemento: el,
            display: el.style.display
          });
          el.style.display = 'none';
        });
      });
      
      // Expandir todas as FAQs
      const faqsExpandidas = [];
      document.querySelectorAll('.faq-question').forEach(q => {
        if (!q.classList.contains('active')) {
          q.classList.add('active');
          faqsExpandidas.push(q);
          const answer = q.nextElementSibling;
          if (answer) {
            answer.classList.add('active');
            faqsExpandidas.push(answer);
          }
        }
      });
      
      // Abrir janela de impress√£o
      setTimeout(() => {
        window.print();
        
        // Restaurar elementos ap√≥s impress√£o
        setTimeout(() => {
          // Restaurar displays originais
          estadosOriginais.forEach(item => {
            item.elemento.style.display = item.display;
          });
          
          // Fechar FAQs que foram expandidas
          faqsExpandidas.forEach(el => {
            el.classList.remove('active');
          });
        }, 1000);
      }, 500);
    }

    // Controle do √≠ndice flutuante
    function toggleIndex() {
      const index = document.getElementById('floatingIndex');
      index.classList.toggle('collapsed');
    }

    // Demonstra√ß√£o interativa do modo
    function demonstrarModo(modo) {
      const statusElement = document.getElementById('demoStatus');
      const sliderContainer = document.getElementById('demoSliderContainer');
      
      if (modo === 'manual') {
        statusElement.textContent = 'üîß Sistema em Modo Manual - Controles Liberados';
        statusElement.className = 'demo-status manual';
        sliderContainer.style.display = 'block';
        toast.success('Modo Manual Ativo', 'Agora voc√™ pode ajustar o brilho manualmente');
      } else {
        statusElement.textContent = 'ü§ñ Sistema em Modo Autom√°tico - Funcionamento Autom√°tico';
        statusElement.className = 'demo-status automatico';
        sliderContainer.style.display = 'none';
        toast.info('Modo Autom√°tico Ativo', 'Sistema funcionando conforme agendamentos');
      }
    }

    // Atualiza√ß√£o do slider de demonstra√ß√£o
    function atualizarDemoSlider(valor) {
      const sliderElement = document.getElementById('demoSlider');
      const valueElement = document.getElementById('demoValue');
      
      valueElement.textContent = valor + '%';
      
      // Atualizar cor do slider
      const porcentagem = valor;
      sliderElement.style.background = `linear-gradient(to right, #8e44ad  0%, #8e44ad  ${porcentagem}%, #8e44ad  ${porcentagem}%, #e0e0e0 100%)`;
    }

    // Controle de FAQ
    function toggleFaq(button) {
      const answer = button.nextElementSibling;
      const isActive = button.classList.contains('active');
      
      // Fechar todas as FAQs abertas
      document.querySelectorAll('.faq-question.active').forEach(q => {
        q.classList.remove('active');
        q.nextElementSibling.classList.remove('active');
      });
      
      // Abrir a FAQ clicada se ela n√£o estava ativa
      if (!isActive) {
        button.classList.add('active');
        answer.classList.add('active');
      }
    }

    // Navega√ß√£o suave para √¢ncoras
    function navegarPara(secaoId) {
      const secao = document.getElementById(secaoId);
      if (secao) {
        secao.scrollIntoView({ 
          behavior: 'smooth',
          block: 'start'
        });
        
        // Atualizar √≠ndice ativo
        document.querySelectorAll('.index-link').forEach(link => {
          link.classList.remove('active');
        });
        document.querySelector(`[href="#${secaoId}"]`)?.classList.add('active');
        
        toast.info('Navega√ß√£o', `${secao.querySelector('.section-title').textContent.replace(/^.+?\s/, '')}`);
      }
    }

    // Monitoramento de scroll para atualizar √≠ndice ativo
    function monitorarScroll() {
      // Atualizar se√ß√£o ativa no √≠ndice
      const secoes = document.querySelectorAll('.manual-section[id]');
      let secaoAtiva = '';
      
      secoes.forEach(secao => {
        const rect = secao.getBoundingClientRect();
        if (rect.top <= 150 && rect.bottom >= 150) {
          secaoAtiva = secao.id;
        }
      });
      
      if (secaoAtiva) {
        document.querySelectorAll('.index-link').forEach(link => {
          link.classList.remove('active');
        });
        document.querySelector(`[href="#${secaoAtiva}"]`)?.classList.add('active');
      }
    }

    // Event Listeners
    document.addEventListener('DOMContentLoaded', function() {
      // Configurar busca
      const searchInput = document.getElementById('searchInput');
      if (searchInput) {
        searchInput.addEventListener('keydown', (e) => {
          if (e.key === 'Escape') {
            limparPesquisa();
          } else if (e.key === 'Enter') {
            e.preventDefault();
            realizarBusca(e.target.value);
          } else if (e.key === 'ArrowDown' && resultadosBusca.length > 0) {
            e.preventDefault();
            navegarProximoResultado();
          } else if (e.key === 'ArrowUp' && resultadosBusca.length > 0) {
            e.preventDefault();
            navegarResultadoAnterior();
          }
        });
      }
      
      // Verificar se as bibliotecas PDF foram carregadas
      setTimeout(() => {
        if (typeof window.jsPDF === 'undefined' || typeof html2canvas === 'undefined') {
          // Alterar fun√ß√£o do bot√£o para m√©todo simples
          document.getElementById('downloadPdfBtn').onclick = gerarPDFSimples;
        }
      }, 3000);
      
      // Notifica√ß√£o de boas-vindas
      setTimeout(() => {
        toast.system('Manual Carregado', 'Bem-vindo ao Manual de Opera√ß√£o! Digite sua busca e pressione ENTER. Use ‚Üë‚Üì para navegar entre resultados.', {
          duration: 8000
        });
      }, 1000);
      
      // Configurar navega√ß√£o do √≠ndice
      document.querySelectorAll('.index-link').forEach(link => {
        link.addEventListener('click', function(e) {
          e.preventDefault();
          const secaoId = this.getAttribute('href').substring(1);
          navegarPara(secaoId);
        });
      });
      
      // Configurar anima√ß√£o de piscar para demo
      const style = document.createElement('style');
      style.textContent = `
        @keyframes piscar {
          0% { opacity: 1; transform: scale(1); }
          50% { opacity: 0.6; transform: scale(0.98); }
          100% { opacity: 1; transform: scale(1); }
        }
      `;
      document.head.appendChild(style);
      
      // Monitorar scroll
      window.addEventListener('scroll', monitorarScroll);
      
      // Inicializar demonstra√ß√µes
      atualizarDemoSlider(50);
      
      // Detectar se √© mobile para ajustar √≠ndice
      if (window.innerWidth <= 1024) {
        document.getElementById('floatingIndex').classList.remove('collapsed');
      }

      // Efeitos de hover nos componentes
      document.querySelectorAll('.componente-item').forEach(item => {
        item.addEventListener('mouseenter', function() {
          this.style.transform = 'translateY(-3px) scale(1.01)';
        });
        
        item.addEventListener('mouseleave', function() {
          this.style.transform = 'translateY(-2px) scale(1)';
        });
      });

      // Anima√ß√£o de carregamento
      document.querySelectorAll('.componente-item, .sistema-card').forEach((item, index) => {
        item.style.opacity = '0';
        item.style.transform = 'translateY(20px)';
        
        setTimeout(() => {
          item.style.transition = 'all 0.6s ease';
          item.style.opacity = '1';
          item.style.transform = 'translateY(0)';
        }, index * 100);
      });
    });

    // Redimensionamento da janela
    window.addEventListener('resize', function() {
      if (window.innerWidth <= 1024) {
        document.getElementById('floatingIndex').classList.remove('collapsed');
      }
    });

    // Atalhos de teclado
    document.addEventListener('keydown', function(e) {
      // Ctrl + Home = Voltar ao topo
      if (e.ctrlKey && e.key === 'Home') {
        e.preventDefault();
        voltarAoTopo();
      }
      
      // F1 = Mostrar/ocultar √≠ndice
      if (e.key === 'F1') {
        e.preventDefault();
        toggleIndex();
      }
      
      // Ctrl + S = Download PDF
      if (e.ctrlKey && e.key === 's') {
        e.preventDefault();
        gerarPDF();
      }
      
      // Ctrl + P = Imprimir/PDF simples
      if (e.ctrlKey && e.key === 'p') {
        e.preventDefault();
        gerarPDFSimples();
      }
    });

    // Feedback de intera√ß√£o
    document.querySelectorAll('.demo-btn').forEach(btn => {
      btn.addEventListener('click', function() {
        // Feedback visual apenas
        this.style.transform = 'scale(0.95)';
        setTimeout(() => {
          this.style.transform = '';
        }, 150);
      });
    });

    // Auto-save da posi√ß√£o do scroll (para recarregamentos de p√°gina)
    window.addEventListener('beforeunload', function() {
      localStorage.setItem('manualScrollPosition', window.pageYOffset);
    });

    window.addEventListener('load', function() {
      const savedPosition = localStorage.getItem('manualScrollPosition');
      if (savedPosition) {
        setTimeout(() => {
          window.scrollTo(0, parseInt(savedPosition));
          localStorage.removeItem('manualScrollPosition');
        }, 100);
      }
    });

    // ========== VERIFICA√á√ÉO DE CONEX√ÉO ==========
    
    // Vari√°veis para controle de status de conex√£o
    let statusConexao = false;
    let toastConexaoId = null;
    let verificandoConexao = false;
    let tentativasFalhas = 0;

    // Fun√ß√£o Para Verificar Conex√£o Com a Rede WiFi Espec√≠fica
    async function verificarConexaoViza() {
      // Se j√° sabemos que n√£o h√° internet, n√£o adianta tentar
      if (!navigator.onLine) {
        return false;
      }

      try {
        // Verificar se √© poss√≠vel acessar o sistema Viza
        const controller = new AbortController();
        const timeoutId = setTimeout(() => controller.abort(), 4000); // 4 segundos

        const response = await fetch('/estado', {
          method: 'GET',
          signal: controller.signal,
          cache: 'no-cache'
        });
        clearTimeout(timeoutId);

        if (response.ok) {
          tentativasFalhas = 0; // Resetar contador em caso de sucesso
          return true;
        } else {
          tentativasFalhas++;
          return false;
        }
      } catch (error) {
        tentativasFalhas++;
        console.log(`Erro na verifica√ß√£o de conex√£o (tentativa ${tentativasFalhas}):`, error.name);
        // S√≥ retorna 'false' de fato ap√≥s 6 tentativas
        if (tentativasFalhas < 6) {
          return true; // Finge que est√° online para ser mais tolerante
        }
        console.log('Erro na verifica√ß√£o de conex√£o:', error.name);
        return false;
      }
    }

    // Fun√ß√£o Para Atualizar Status da Conex√£o
    async function atualizarStatusConexao() {
      if (verificandoConexao) return;
      verificandoConexao = true;

      try {
        const conectadoViza = await verificarConexaoViza();
        const statusElement = document.getElementById('status-conexao');
        const statusText = document.getElementById('status-text');
        
        if (statusElement) {
          if (conectadoViza && !statusConexao) {
            // Conectou √† rede Viza
            statusText.textContent = 'Conectado';
            statusElement.className = 'status-conexao status-online';
            
            // Remover toast de conex√£o perdida se existir
            if (toastConexaoId) {
              toast.remove(toastConexaoId);
              toastConexaoId = null;
            }
            
            toast.success('Conectado √† rede Ilumina√ß√£o_Viza', 'Sistema de ilumina√ß√£o dispon√≠vel');

          } else if (!conectadoViza && statusConexao) {
            // Perdeu conex√£o com a rede Viza
            statusText.textContent = 'Desconectado';
            statusElement.className = 'status-conexao status-offline';
            
            toastConexaoId = toast.error('Fora da rede Ilumina√ß√£o_Viza', 'Conecte-se √† rede WiFi "Ilumina√ß√£o_Viza" para acessar o sistema', {
              persistent: true,
              action: {
                text: 'Tentar Novamente',
                callback: () => {
                  atualizarStatusConexao();
                  toast.info('Verificando...', 'Tentando conectar √† rede Ilumina√ß√£o_Viza');
                }
              }
            });
          }
          
          statusConexao = conectadoViza;
        }
      } catch (error) {
        console.error('Erro ao verificar status:', error);
      } finally {
        verificandoConexao = false;
      }
    }

    // Monitoramento de rede
    function monitorarConexao() {
      // Verificar mudan√ßas na conectividade geral
      window.addEventListener('online', () => {
        setTimeout(atualizarStatusConexao, 1000); // Aguardar 1 segundo e verificar
      });
      
      window.addEventListener('offline', () => {
        if (statusConexao) {
          const statusElement = document.getElementById('status-conexao');
          const statusText = document.getElementById('status-text');
          
          statusText.textContent = 'Desconectado';
          statusElement.className = 'status-conexao status-offline';
          
          toast.warning('Sem Conex√£o com Internet', 'Verifique sua conectividade', {
            persistent: true
          });
          
          statusConexao = false;
        }
      });

      // Verificar quando a p√°gina ganha foco (usu√°rio volta ao app)
      window.addEventListener('focus', () => {
        setTimeout(atualizarStatusConexao, 500);
      });

      // Verificar quando h√° mudan√ßa de visibilidade da p√°gina
      document.addEventListener('visibilitychange', () => {
        if (!document.hidden) {
          setTimeout(atualizarStatusConexao, 500);
        }
      });
    }

    // Inicializar monitoramento de conex√£o
    monitorarConexao();
    
    // Verificar status inicial da conex√£o
    setTimeout(atualizarStatusConexao, 1000);
    
    // Verifica√ß√£o peri√≥dica a cada 10 segundos
    setInterval(atualizarStatusConexao, 10000);

  </script>
</body>
</html>